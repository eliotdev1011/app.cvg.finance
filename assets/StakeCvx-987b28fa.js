import{r as o,$ as q,e as E,u as j,n as u,a0 as h,j as e,b as F,ax as T,k as X,ad as _,Y as R,ay as H,_ as G}from"./index-614b6d1c.js";import{s as g}from"./staking.convex.service-00231db1.js";import{P as O}from"./PanelV2-fa4ca1d1.js";import{H as U}from"./HourGlassIcon-925d813a.js";import{I as B}from"./InfoCircle-1ebdcaad.js";import"./convexStaking-08fe3d07.js";import"./CvxAssetStakingService-f8fb6638.js";import"./CurvePool-852682be.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},l=new Error().stack;l&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[l]="03379012-943b-44af-b33d-c0728f4dd922",t._sentryDebugIdIdentifier="sentry-dbid-03379012-943b-44af-b33d-c0728f4dd922")}catch{}})();const w=o.createContext(null),y=["cvgCVX","CVX1"],K=({children:t})=>{const[l,i]=o.useState(void 0),[s,d]=o.useState(void 0),[r,f]=o.useState(void 0),[m,N]=o.useState(void 0),{address:v}=q(),{ecosystemInfo:C}=o.useContext(E);o.useEffect(()=>{A().then(),P().then()},[]),o.useEffect(()=>{L().then()},[v]),o.useEffect(()=>{k().then()},[l,s]);const D=o.useMemo(()=>{if(!l||l.loading)return[];if(!s||s.loading||s.error)return l;const x=s,a={claimableDollar:0,tvlDollar:0,depositedDollar:0},p=l.map(c=>{const b=x.find(V=>V.stakingContract===c.stakingContract)||{nextTvl:0n},$=m&&m[c.stakingContract]||{},n=g.aggregateData(c,b,r,$,C);return a.claimableDollar+=n.claimableDollar,a.depositedDollar+=n.depositedDollar,a.tvlDollar+=n.tvlDollar,{...n,...b,formatted:{tvlDollar:j(n.tvlDollar||0,0),depositedDollar:u(n.depositedDollar||0,!0,0),tvl:u(n.tvl),deposited:u(n.deposited||0),claimableDollar:u(n.claimableDollar||0,!0,0),projectedApr:u(n?.projectedApr,!1,2),currentApr:u(n?.currentApr,!1,2)}}});return a.claimableDollar=j(a.claimableDollar,0),a.depositedDollar=j(a.depositedDollar,0),a.tvlDollar=j(a.tvlDollar,0),{listCvgCvx:p.filter(c=>y.includes(c.key)),listCvxAsset:p.filter(c=>!y.includes(c.key)),totals:a}},[s,l,v,r,m]),k=async()=>{if(!l||l?.loading||l?.error)return{};if(!r&&!r?.loading){const x=await g.getTokenInList(l,s);x.length&&h(async()=>await F.getPrices(x),f).then()}},L=async()=>{await h(async()=>{const[p,c]=await g.getListInfo(v);return[...p,c]},p=>{d(p)})},A=async()=>{await h(async()=>await g.getList(),i)},P=async()=>{await h(async()=>await g.getAprForAllStaking(),N)},S={prices:r,aprs:m,displayData:D};return e.jsx(w.Provider,{value:S,children:t})};function M({stakingInfo:t}){const l=T();function i(){t.key==="CVX1"?l(`/stake/sdt?filter=${t.key}`):l(`/stake/cvx/${t.key}`)}return e.jsx("div",{onClick:i,children:e.jsxs(O,{className:"relative flex align-items-center flex-wrap gap-2 cursor-pointer hover-panel xl:flex-nowrap",children:[e.jsxs("div",{className:"flex flex-wrap justify-content-between  w-full lg:align-items-center xl:w-auto xl:gap-0 xl:w-6",children:[e.jsxs("div",{className:"flex mb-2  w-full lg:w-4 lg:mb-0 align-items-center xl:w-auto xl:w-5",children:[e.jsx("img",{src:t?.logo,alt:`${t?.label} logo`,className:"staking-asset-logo w-3rem mr-2",title:t?.label,onError:s=>{s.target.onerror=null,s.target.src=X}}),e.jsx("div",{className:" p-1 white-space-nowrap  mb-1 min-w-1",children:e.jsx("span",{className:"p-1 px-2 text-2xl",children:t?.label})})]}),e.jsx("div",{className:"flex font-main lg:w-4 lg:justify-content-center xl:w-auto",children:e.jsx("div",{className:"flex white-space-nowrap  gap-2 align-items-center",children:e.jsxs("div",{className:"justify-content-center",children:[e.jsx("div",{className:"p-1 color-quiet text-center",children:"vAPR"}),!t?.formatted?.currentApr||t?.formatted?.currentApr==="-"?e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex relative gap-2 justify-content-center align-items-center",children:e.jsxs("span",{className:"bg-apr text-lg border-round-lg p-2 font-semibold",children:[t?.formatted?.projectedApr,"%"]})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex relative gap-2 justify-content-center align-items-center",children:e.jsxs("span",{className:"bg-apr text-lg border-round-lg p-2 font-semibold",children:[t?.formatted?.currentApr,"%"]})}),e.jsxs("span",{className:"p-1 text-sm",children:["Proj: ",t?.formatted?.projectedApr,"%"]})]})]})})}),e.jsx("div",{className:"flex justify-content-end min-w-6rem lg:justify-content-end lg:w-4 xl:w-auto lg:h-2-5rem xl:mr-6",children:e.jsxs("div",{className:"flex  gap-2  align-items-center ",children:[e.jsx("img",{src:_,alt:"convergence",className:"w-2rem"}),e.jsx("i",{className:`mt-1 w-1-5rem ${t?.isUnderlyingProcessed?"color-green":"color-tonic"}`,children:e.jsx(U,{})}),e.jsx(B,{className:"mt-1 hidden md:block",children:e.jsx("div",{children:t?.isUnderlyingProcessed?e.jsx("span",{children:"Rewards have been harvested for the current Cycle."}):e.jsx("span",{children:"Rewards have not been harvested for the current Cycle."})})})]})})]}),e.jsx("div",{className:"hidden xl:block xl:w-0",children:e.jsx("div",{className:" h-2-5rem mx-auto border-right-1 border-dark-gray -translate-x-50"})}),e.jsx("div",{className:"w-full xl:hidden h-0-25rem  border-top-2 border-dark-gray lg:my-3 my-2"}),e.jsxs("div",{className:"inline-flex flex-grow-1 justify-content-between align-content-evenly xl:mx-6",children:[e.jsxs("div",{className:"flex  min-w-7rem flex-column gap-1 justify-content-start lg:text-center",children:[e.jsx("span",{className:"color-quiet text-lg",children:"TVL"}),e.jsxs("span",{className:"",children:["$",t?.formatted?.tvlDollar]}),e.jsxs("span",{className:"color-quiet text-xs",children:[t?.formatted?.tvl," ",t?.stkLabel]})]}),t.key!=="CVX1"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex  min-w-7rem flex-column gap-1 justify-content-start text-right  md:text-center",children:[e.jsx("span",{className:"color-quiet text-lg",children:"Deposited"}),e.jsxs("span",{children:["$",t?.formatted?.depositedDollar," "]}),e.jsxs("span",{className:"color-quiet text-xs",children:[t?.formatted?.deposited," ",t?.stkLabel]})]}),e.jsxs("div",{className:"hidden md:flex min-w-7rem flex-column gap-1 text-right lg:text-center justify-content-start",children:[e.jsx("span",{className:"color-quiet text-lg",children:"Claimable"}),e.jsxs("span",{children:["$",t?.formatted?.claimableDollar," "]}),e.jsx("span",{className:"color-quiet text-xs",children:" "})]})]})]})]})})}function Y(){const{displayData:t}=o.useContext(w),l=({title:d})=>e.jsxs("div",{className:"flex w-full gap-2 align-items-center ",children:[e.jsx("span",{className:"bg-blue color-white p-2 white-space-nowrap",children:d}),e.jsx("div",{className:"w-full border-bottom-1 border-dark-gray"})]}),i=({loading:d,list:r})=>e.jsxs("div",{className:"flex flex-column gap-3",children:[!!r?.length&&r?.map((f,m)=>e.jsx("div",{className:"flex flex-column gap-3",children:e.jsx(M,{stakingInfo:f})},f?.stakingContract||m)),!r?.length&&e.jsx(R,{children:e.jsx("div",{className:"w-full h-10rem flex align-items-center justify-content-center ",children:d?e.jsx(H,{className:"w-10rem"}):e.jsx(e.Fragment,{children:"No staking."})})})]}),s=({label:d,display:r})=>e.jsxs("div",{className:"bg-black  px-2 py-2  md:px-3 w-full  md:gap-2 md:w-auto flex justify-content-between ",children:[e.jsxs("span",{children:[d,":"]})," ",e.jsx("span",{className:"color-tonic",children:r})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-lg flex flex-wrap md:justify-content-end md:gap-2  align-items-center text-sm",children:[e.jsx(s,{label:"TVL",display:`$${t?.totals?.tvlDollar?t?.totals?.tvlDollar:"-"}`}),e.jsx(s,{label:"Total deposited",display:`$${t?.totals?.depositedDollar?t?.totals?.depositedDollar:"-"}`}),e.jsx(s,{label:"Total claimable",display:`$${t?.totals?.claimableDollar?t?.totals?.claimableDollar:"-"}`})]}),e.jsxs("div",{className:"flex flex-column gap-4 mt-4",children:[e.jsx(l,{title:"CVX Liquid Locker & Stablepool"}),e.jsx(i,{loading:t?.loading,list:t?.listCvgCvx}),e.jsx(l,{title:"CVX Tokens Staking "}),e.jsx(i,{loading:t?.loading,list:t?.listCvxAsset})]})]})}function le(){return e.jsx("main",{className:" flex justify-content-center",children:e.jsx(G,{children:e.jsx(K,{children:e.jsx("div",{className:"flex flex-column ",children:e.jsx(Y,{})})})})})}export{le as default};
