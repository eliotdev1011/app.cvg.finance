import{B as P,s as r,m as S,c as V,a as I,aa as v,a5 as m,b1 as _,n as h,am as C,b2 as L,ae as D,d as N,aj as E,M as A,b as R,a4 as $,a2 as b}from"./index-614b6d1c.js";import{s as Y}from"./rewards.service-40a9454a.js";(function(){try{var f=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[t]="018f1318-2ba7-4ac3-9fec-45f4fc67205d",f._sentryDebugIdIdentifier="sentry-dbid-018f1318-2ba7-4ac3-9fec-45f4fc67205d")}catch{}})();const G="hh-sol-artifact-1",W="LockingPositionService",F="contracts/Locking/LockingPositionService.sol",U=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint24",name:"startCycle",type:"uint24"},{internalType:"uint24",name:"lastEndCycle",type:"uint24"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"uint104",name:"totalCvgLocked",type:"uint104"},{internalType:"uint96",name:"mgCvgAmount",type:"uint96"}],indexed:!1,internalType:"struct ILockingPositionService.LockingPosition",name:"lockingPosition",type:"tuple"}],name:"IncreaseLockAmount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint24",name:"startCycle",type:"uint24"},{internalType:"uint24",name:"lastEndCycle",type:"uint24"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"uint104",name:"totalCvgLocked",type:"uint104"},{internalType:"uint96",name:"mgCvgAmount",type:"uint96"}],indexed:!1,internalType:"struct ILockingPositionService.LockingPosition",name:"lockingPosition",type:"tuple"},{indexed:!1,internalType:"uint256",name:"oldEndCycle",type:"uint256"}],name:"IncreaseLockTime",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint24",name:"startCycle",type:"uint24"},{internalType:"uint24",name:"lastEndCycle",type:"uint24"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"uint104",name:"totalCvgLocked",type:"uint104"},{internalType:"uint96",name:"mgCvgAmount",type:"uint96"}],indexed:!1,internalType:"struct ILockingPositionService.LockingPosition",name:"lockingPosition",type:"tuple"},{indexed:!1,internalType:"uint256",name:"oldEndCycle",type:"uint256"}],name:"IncreaseLockTimeAndAmount",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"LockingPositionBurn",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{components:[{internalType:"uint24",name:"startCycle",type:"uint24"},{internalType:"uint24",name:"lastEndCycle",type:"uint24"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"uint104",name:"totalCvgLocked",type:"uint104"},{internalType:"uint96",name:"mgCvgAmount",type:"uint96"}],indexed:!1,internalType:"struct ILockingPositionService.LockingPosition",name:"lockingPosition",type:"tuple"}],name:"MintLockingPosition",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newYsSupply",type:"uint256"},{indexed:!1,internalType:"uint256",name:"veCvgSupply",type:"uint256"},{indexed:!1,internalType:"uint256",name:"cycle",type:"uint256"}],name:"UpdateTotalSupplies",type:"event"},{inputs:[],name:"acceptOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"balanceOfMgCvg",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"balanceOfVeCvg",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"uint256",name:"_cycleId",type:"uint256"}],name:"balanceOfYsCvgAt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"burnPosition",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"checkpoints",outputs:[{internalType:"uint24",name:"cycleId",type:"uint24"},{internalType:"uint232",name:"ysBalance",type:"uint232"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvg",outputs:[{internalType:"contract ICvg",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvgControlTower",outputs:[{internalType:"contract ICvgControlTower",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvgRewards",outputs:[{internalType:"contract ICvgRewards",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"cycleId",type:"uint256"}],name:"getTotalSupplyAtAndBalanceOfYs",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"cycleId",type:"uint256"}],name:"getTotalSupplyHistoryAndBalanceOfYs",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint128",name:"amount",type:"uint128"},{internalType:"address",name:"operator",type:"address"}],name:"increaseLockAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"durationAdd",type:"uint256"}],name:"increaseLockTime",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint24",name:"durationAdd",type:"uint24"},{internalType:"uint128",name:"amount",type:"uint128"},{internalType:"address",name:"operator",type:"address"}],name:"increaseLockTimeAndAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract ICvgControlTower",name:"_cvgControlTower",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"isContractLocker",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"isSpecialLocker",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"lockingInfo",outputs:[{components:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint256",name:"cvgLocked",type:"uint256"},{internalType:"uint256",name:"lockEnd",type:"uint256"},{internalType:"uint256",name:"ysPercentage",type:"uint256"},{internalType:"uint256",name:"mgCvg",type:"uint256"}],internalType:"struct LockingPositionService.LockingInfo",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"lockingPositionDelegate",outputs:[{internalType:"contract ILockingPositionDelegate",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"lockingPositionManager",outputs:[{internalType:"contract ILockingPositionManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"lockingPositions",outputs:[{internalType:"uint24",name:"startCycle",type:"uint24"},{internalType:"uint24",name:"lastEndCycle",type:"uint24"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"uint104",name:"totalCvgLocked",type:"uint104"},{internalType:"uint96",name:"mgCvgAmount",type:"uint96"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_user",type:"address"}],name:"mgCvgVotingPowerPerAddress",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint24",name:"lockDuration",type:"uint24"},{internalType:"uint128",name:"amount",type:"uint128"},{internalType:"uint8",name:"ysPercentage",type:"uint8"},{internalType:"address",name:"receiver",type:"address"},{internalType:"bool",name:"isAddToManagedTokens",type:"bool"}],name:"mintPosition",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract ICvgRewards",name:"_cvgRewards",type:"address"}],name:"setCvgRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IVotingPowerEscrow",name:"_veCvg",type:"address"}],name:"setVotingPowerEscrow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"contractWL",type:"address"}],name:"toggleContractLocker",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"specialLocker",type:"address"}],name:"toggleSpecialLocker",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"tokenInfos",outputs:[{components:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"uint128",name:"startCycle",type:"uint128"},{internalType:"uint128",name:"endCycle",type:"uint128"},{internalType:"uint256",name:"cvgLocked",type:"uint256"},{internalType:"uint256",name:"ysActual",type:"uint256"},{internalType:"uint256",name:"ysTotal",type:"uint256"},{internalType:"uint256",name:"veCvgActual",type:"uint256"},{internalType:"uint256",name:"mgCvg",type:"uint256"},{internalType:"uint256",name:"ysPercentage",type:"uint256"}],internalType:"struct ILockingPositionService.TokenView",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"totalSuppliesTracking",outputs:[{internalType:"uint128",name:"ysToAdd",type:"uint128"},{internalType:"uint128",name:"ysToSub",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_at",type:"uint256"}],name:"totalSupplyOfYsCvgAt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"totalSupplyYsCvgHistories",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"updateYsTotalSupply",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"veCvg",outputs:[{internalType:"contract IVotingPowerEscrow",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_user",type:"address"}],name:"veCvgVotingPowerPerAddress",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],k={_format:G,contractName:W,sourceName:F,abi:U},B="hh-sol-artifact-1",H="LockingPositionDelegate",j="contracts/Locking/LockingPositionDelegate.sol",z=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"percentage",type:"uint256"}],name:"DelegateMetagovernance",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"delegatee",type:"address"}],name:"DelegateShare",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"address",name:"to",type:"address"}],name:"DelegateVeCvg",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"acceptOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"address",name:"minter",type:"address"}],name:"addTokenAtMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"bool",name:"cleanVeDelegatees",type:"bool"},{internalType:"bool",name:"cleanMgDelegatees",type:"bool"}],name:"cleanDelegatees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"cleanDelegateesOnTransfer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cvgControlTower",outputs:[{internalType:"contract ICvgControlTower",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{components:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint96",name:"percentage",type:"uint96"}],internalType:"struct LockingPositionDelegate.MgCvgDelegatee[]",name:"_delegateesData",type:"tuple[]"}],name:"delegateMgCvg",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"address",name:"_to",type:"address"}],name:"delegateVeCvg",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"address",name:"_to",type:"address"}],name:"delegateYsCvg",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"delegatedMgCvg",outputs:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint96",name:"percentage",type:"uint96"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"delegatedVeCvg",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"delegatedYsCvg",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"getDelegatedMgCvg",outputs:[{components:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint96",name:"percentage",type:"uint96"}],internalType:"struct LockingPositionDelegate.MgCvgDelegatee[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_delegatee",type:"address"},{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"getIndexForMgCvgDelegatee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_delegatee",type:"address"},{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"getIndexForVeDelegatee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getMgCvgDelegatees",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"address",name:"_to",type:"address"}],name:"getMgDelegateeInfoPerTokenAndAddress",outputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"getTokenMgOwnedAndDelegated",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"getTokenOwnedAndDelegated",outputs:[{components:[{internalType:"uint256[]",name:"owneds",type:"uint256[]"},{internalType:"uint256[]",name:"mgDelegateds",type:"uint256[]"},{internalType:"uint256[]",name:"veDelegateds",type:"uint256[]"}],internalType:"struct LockingPositionDelegate.OwnedAndDelegated",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_addr",type:"address"}],name:"getTokenVeOwnedAndDelegated",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getVeCvgDelegatees",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract ICvgControlTower",name:"_cvgControlTower",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"lockingPositionManager",outputs:[{internalType:"contract ILockingPositionManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"uint256[]",name:"owneds",type:"uint256[]"},{internalType:"uint256[]",name:"mgDelegateds",type:"uint256[]"},{internalType:"uint256[]",name:"veDelegateds",type:"uint256[]"}],internalType:"struct LockingPositionDelegate.OwnedAndDelegated",name:"_ownedAndDelegatedTokens",type:"tuple"}],name:"manageOwnedAndDelegated",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"maxMgDelegatees",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxTokenIdsDelegated",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"mgCvgDelegatees",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"bool",name:"removeVeDelegated",type:"bool"},{internalType:"bool",name:"removeMgDelegated",type:"bool"}],name:"removeTokenIdDelegated",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract ILockingPositionManager",name:"_lockingPositionManager",type:"address"}],name:"setLockingPositionManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxMgDelegatees",type:"uint256"}],name:"setMaxMgDelegatees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxTokenIdsDelegated",type:"uint256"}],name:"setMaxTokenIdsDelegated",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"veCvgDelegatees",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],Z={_format:B,contractName:H,sourceName:j,abi:z},q="hh-vyper-artifact-1",J="GaugeController",K="contracts/Locking/GaugeController.vy",Q=[{name:"CommitOwnership",inputs:[{name:"admin",type:"address",indexed:!1}],anonymous:!1,type:"event"},{name:"ApplyOwnership",inputs:[{name:"admin",type:"address",indexed:!1}],anonymous:!1,type:"event"},{name:"AddType",inputs:[{name:"name",type:"string",indexed:!1},{name:"type_id",type:"int128",indexed:!1}],anonymous:!1,type:"event"},{name:"NewTypeWeight",inputs:[{name:"type_id",type:"int128",indexed:!1},{name:"time",type:"uint256",indexed:!1},{name:"weight",type:"uint256",indexed:!1},{name:"total_weight",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{name:"NewGaugeWeight",inputs:[{name:"gauge_address",type:"address",indexed:!1},{name:"time",type:"uint256",indexed:!1},{name:"weight",type:"uint256",indexed:!1},{name:"total_weight",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{name:"VoteForGauge",inputs:[{name:"time",type:"uint256",indexed:!1},{name:"tokenId",type:"uint256",indexed:!1},{name:"gauge_addr",type:"address",indexed:!1},{name:"weight",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{name:"NewGauge",inputs:[{name:"addr",type:"address",indexed:!1},{name:"gauge_type",type:"int128",indexed:!1},{name:"weight",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{stateMutability:"nonpayable",type:"constructor",inputs:[],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"initialize",inputs:[{name:"setControlTower",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"set_lock",inputs:[{name:"isLock",type:"bool"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"toggle_locker",inputs:[{name:"lockerAddress",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"toggle_vote_pause",inputs:[{name:"gaugeAddress",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"toggle_votes_pause",inputs:[{name:"gaugeAddresses",type:"address[]"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"commit_transfer_ownership",inputs:[{name:"addr",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"apply_transfer_ownership",inputs:[],outputs:[]},{stateMutability:"view",type:"function",name:"gauge_types",inputs:[{name:"_addr",type:"address"}],outputs:[{name:"",type:"int128"}]},{stateMutability:"nonpayable",type:"function",name:"add_gauge",inputs:[{name:"addr",type:"address"},{name:"gauge_type",type:"int128"},{name:"weight",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"checkpoint",inputs:[],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"checkpoint_gauge",inputs:[{name:"addr",type:"address"}],outputs:[]},{stateMutability:"view",type:"function",name:"gauge_relative_weight",inputs:[{name:"addr",type:"address"},{name:"time",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"nonpayable",type:"function",name:"gauge_relative_weight_write",inputs:[{name:"addr",type:"address"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"nonpayable",type:"function",name:"gauge_relative_weight_writes",inputs:[{name:"addrs",type:"address[]"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"add_type",inputs:[{name:"_name",type:"string"},{name:"weight",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"change_type_weight",inputs:[{name:"type_id",type:"int128"},{name:"weight",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"change_gauge_weight",inputs:[{name:"addr",type:"address"},{name:"weight",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"kill_gauge",inputs:[{name:"addr",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"multi_vote",inputs:[{name:"param",type:"tuple[]",components:[{name:"tokenId",type:"uint256"},{name:"votes",type:"tuple[]",components:[{name:"gauge_address",type:"address"},{name:"weight",type:"uint256"}]}]}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"simple_vote",inputs:[{name:"tokenId",type:"uint256"},{name:"_gauge_addr",type:"address"},{name:"_user_weight",type:"uint256"}],outputs:[]},{stateMutability:"view",type:"function",name:"get_gauge_weight_normal",inputs:[{name:"addr",type:"address"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"get_gauge_weight",inputs:[{name:"addr",type:"address"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"get_gauge_weight_sum",inputs:[{name:"addrs",type:"address[]"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"get_gauge_weights",inputs:[{name:"addrs",type:"address[]"}],outputs:[{name:"",type:"uint256[]"}]},{stateMutability:"view",type:"function",name:"get_gauge_weights_and_types",inputs:[{name:"addrs",type:"address[]"}],outputs:[{name:"",type:"tuple[]",components:[{name:"weight",type:"uint256"},{name:"type_weight",type:"uint256"},{name:"gauge_type",type:"int128"}]}]},{stateMutability:"view",type:"function",name:"get_nft_datas",inputs:[{name:"inputParams",type:"tuple[]",components:[{name:"tokenId",type:"uint256"},{name:"gaugeAddresses",type:"address[]"}]}],outputs:[{name:"",type:"tuple[]",components:[{name:"tokenId",type:"uint256"},{name:"nft_power",type:"uint256"},{name:"balanceOf",type:"uint256"},{name:"gaugeData",type:"tuple[]",components:[{name:"gaugeAddress",type:"address"},{name:"nft_slopes",type:"tuple",components:[{name:"slope",type:"uint256"},{name:"power",type:"uint256"},{name:"end",type:"uint256"}]},{name:"last_nft_vote",type:"uint256"}]}]}]},{stateMutability:"view",type:"function",name:"get_type_weight",inputs:[{name:"type_id",type:"int128"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"get_total_weight",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"get_weights_sum_per_type",inputs:[{name:"type_id",type:"int128"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"admin",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"future_admin",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"control_tower",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"n_gauge_types",inputs:[],outputs:[{name:"",type:"int128"}]},{stateMutability:"view",type:"function",name:"n_gauges",inputs:[],outputs:[{name:"",type:"int128"}]},{stateMutability:"view",type:"function",name:"gauge_type_names",inputs:[{name:"arg0",type:"int128"}],outputs:[{name:"",type:"string"}]},{stateMutability:"view",type:"function",name:"gauges",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"vote_nft_slopes",inputs:[{name:"arg0",type:"uint256"},{name:"arg1",type:"address"}],outputs:[{name:"",type:"tuple",components:[{name:"slope",type:"uint256"},{name:"power",type:"uint256"},{name:"end",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"vote_nft_power",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"last_nft_vote",inputs:[{name:"arg0",type:"uint256"},{name:"arg1",type:"address"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"points_weight",inputs:[{name:"arg0",type:"address"},{name:"arg1",type:"uint256"}],outputs:[{name:"",type:"tuple",components:[{name:"bias",type:"uint256"},{name:"slope",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"time_weight",inputs:[{name:"arg0",type:"address"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"points_sum",inputs:[{name:"arg0",type:"int128"},{name:"arg1",type:"uint256"}],outputs:[{name:"",type:"tuple",components:[{name:"bias",type:"uint256"},{name:"slope",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"time_sum",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"points_total",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"time_total",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"points_type_weight",inputs:[{name:"arg0",type:"int128"},{name:"arg1",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"time_type_weight",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"isLock",inputs:[],outputs:[{name:"",type:"bool"}]},{stateMutability:"view",type:"function",name:"lockers",inputs:[{name:"arg0",type:"address"}],outputs:[{name:"",type:"bool"}]},{stateMutability:"view",type:"function",name:"killed_gauges",inputs:[{name:"arg0",type:"address"}],outputs:[{name:"",type:"bool"}]},{stateMutability:"view",type:"function",name:"vote_activated",inputs:[{name:"arg0",type:"address"}],outputs:[{name:"",type:"bool"}]},{stateMutability:"view",type:"function",name:"initialized",inputs:[],outputs:[{name:"",type:"bool"}]}],X={},tt={},T={_format:q,contractName:J,sourceName:K,abi:Q,linkReferences:X,deployedLinkReferences:tt},et="hh-vyper-artifact-1",nt="veCVG",at="contracts/Locking/veCVG.vy",it=[{name:"CommitOwnership",inputs:[{name:"admin",type:"address",indexed:!1}],anonymous:!1,type:"event"},{name:"ApplyOwnership",inputs:[{name:"admin",type:"address",indexed:!1}],anonymous:!1,type:"event"},{name:"Deposit",inputs:[{name:"provider",type:"uint256",indexed:!0},{name:"value",type:"uint256",indexed:!1},{name:"locktime",type:"uint256",indexed:!0},{name:"type",type:"int128",indexed:!1},{name:"ts",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{name:"Withdraw",inputs:[{name:"provider",type:"uint256",indexed:!0},{name:"value",type:"uint256",indexed:!1},{name:"ts",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{name:"Supply",inputs:[{name:"prevSupply",type:"uint256",indexed:!1},{name:"supply",type:"uint256",indexed:!1}],anonymous:!1,type:"event"},{stateMutability:"nonpayable",type:"constructor",inputs:[{name:"token_addr",type:"address"},{name:"locking_position_manager_addr",type:"address"},{name:"_name",type:"string"},{name:"_symbol",type:"string"},{name:"_version",type:"string"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"commit_transfer_ownership",inputs:[{name:"addr",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"apply_transfer_ownership",inputs:[],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"commit_smart_wallet_checker",inputs:[{name:"addr",type:"address"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"apply_smart_wallet_checker",inputs:[],outputs:[]},{stateMutability:"view",type:"function",name:"get_last_nft_slope",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"",type:"int128"}]},{stateMutability:"view",type:"function",name:"nft_point_history_ts",inputs:[{name:"_tokenId",type:"uint256"},{name:"_idx",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"locked__end",inputs:[{name:"_tokenId",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"nonpayable",type:"function",name:"checkpoint",inputs:[],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"create_lock",inputs:[{name:"_tokenId",type:"uint256"},{name:"_value",type:"uint256"},{name:"_unlock_time",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"increase_amount",inputs:[{name:"_tokenId",type:"uint256"},{name:"_value",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"increase_unlock_time",inputs:[{name:"_tokenId",type:"uint256"},{name:"_unlock_time",type:"uint256"}],outputs:[]},{stateMutability:"nonpayable",type:"function",name:"withdraw",inputs:[{name:"_tokenId",type:"uint256"}],outputs:[]},{stateMutability:"view",type:"function",name:"balanceOf",inputs:[{name:"_tokenId",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"balanceOfAt",inputs:[{name:"_tokenId",type:"uint256"},{name:"_block",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"total_supply",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"totalSupplyAt",inputs:[{name:"_block",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"locking_position_manager",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"token",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"supply",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"locked",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"tuple",components:[{name:"amount",type:"int128"},{name:"end",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"epoch",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"point_history",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"tuple",components:[{name:"bias",type:"int128"},{name:"slope",type:"int128"},{name:"ts",type:"uint256"},{name:"blk",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"nft_point_history",inputs:[{name:"arg0",type:"uint256"},{name:"arg1",type:"uint256"}],outputs:[{name:"",type:"tuple",components:[{name:"bias",type:"int128"},{name:"slope",type:"int128"},{name:"ts",type:"uint256"},{name:"blk",type:"uint256"}]}]},{stateMutability:"view",type:"function",name:"nft_point_epoch",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"slope_changes",inputs:[{name:"arg0",type:"uint256"}],outputs:[{name:"",type:"int128"}]},{stateMutability:"view",type:"function",name:"name",inputs:[],outputs:[{name:"",type:"string"}]},{stateMutability:"view",type:"function",name:"symbol",inputs:[],outputs:[{name:"",type:"string"}]},{stateMutability:"view",type:"function",name:"version",inputs:[],outputs:[{name:"",type:"string"}]},{stateMutability:"view",type:"function",name:"decimals",inputs:[],outputs:[{name:"",type:"uint256"}]},{stateMutability:"view",type:"function",name:"future_smart_wallet_checker",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"smart_wallet_checker",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"admin",inputs:[],outputs:[{name:"",type:"address"}]},{stateMutability:"view",type:"function",name:"future_admin",inputs:[],outputs:[{name:"",type:"address"}]}],x={_format:et,contractName:nt,sourceName:at,abi:it};class st{bcService=new P;async getHeaderData(t,n){const e=await r.getStaticData();this.gaugeController=e.gaugeController;const a=(t/12n+1n)*12n,s={},i=new A;return i.addDefaultProcessValueFunc(S(s)),i.addCall("totalSupplyOfYsCvgAt",[a],["ysTotalSupply"],e.lockingPositionService),i.addCall("total_supply",void 0,["veTotalSupply"],e.votingPowerEscrow,1),i.addCall("balanceOf",[e.lockingPositionService],["totalCvgLocked"],e.cvgToken,2),i.abis.push(k.abi),i.abis.push(x.abi),i.abis.push(V.abi),await I(i,await this.bcService.getStaticProvider()),s.totalCvgLockedDollar=v(s.totalCvgLocked)*n,s}async getOneGaugeData(t){const{cvgRewards:n}=await r.getStaticData(),e=new m(n,_.abi,await this.bcService.getStaticProvider()),a=[e.lastTotalWeight(),e.getGaugeChunk(t,t+1)],[s,i]=await Promise.all(a);if(!i||!i.length)return{};const o=Number(v(i?.at(0)?.weight)),y=Number(v(s));return{weight:h(o,!0,0),totalWeight:y,percent:h(o/y*100,!0,2)}}async getAllGauges(){const t=[],n=await r.getStaticData(),a=await new m(n.cvgRewards,_.abi,await this.bcService.getStaticProvider()).getGaugeChunk(0,50);let s=0;const i=a.map(u=>{const l=C.find(g=>g.source===u.symbol),c=v(u.weight);return s+=Number(c),{weight:v(u.weight),gaugeType:u.gaugeType,typeWeight:u.typeWeight,name:l?l.name:u.symbol,address:u.stakingAddress}});i.forEach(u=>{const l=Number(u.weight),c=l/Number(s)*100,g=Math.round(c)===0?"≈0.00":c.toFixed(2);t.push({weight:l,percent:g,percentRaw:c,name:u.name,address:u.address})});const o=[];i.forEach(u=>{const l=C.find(c=>c.source===u.name);o.push({name:u.name+" : "+u.address,display:l?.name||u.name,code:u.address})});function y(u,l){return u.weight<l.weight?1:u.weight>l.weight?-1:0}return t.sort(y),{graphData:t,rawData:i,totalWeight:s,gaugesOptions:o}}async getUserData(t){const n=await r.getStaticData(),a=(await new m(n.lockingPositionManager,L.abi,await this.bcService.getStaticProvider()).getTokenIdsForWallet(t)).map(i=>({code:i.toString(),name:`Tkn. ${D(i)}`,group:"Owned"})),s=(await yt.getTokenOwnedAndDelegated(t)).veDelegateds.map(i=>({code:i.toString(),name:`Tkn. ${D(i)}`,group:"Delegated"}));return a.concat(s)}async getNftData(t,n){const e=n.rawData,{gaugeController:a}=await r.getStaticData();let i=(await new m(a,T.abi,await this.bcService.getStaticProvider()).get_nft_datas([{tokenId:t,gaugeAddresses:e.map(p=>p.address)}]))[0].toObject();i.gaugeData=i.gaugeData.map(p=>p.toObject()),i.gaugeData.forEach(p=>{p.nft_slopes=p.nft_slopes.toObject()});const o=i.balanceOf,y=i.nft_power;let u=[];const l=(await(await this.bcService.getStaticProvider()).getBlock()).timestamp,c=new Date(l*1e3);i.gaugeData.forEach(p=>{const w=Number(p.last_nft_vote);let d;w>0&&(d=new Date(Number(p.last_nft_vote)*1e3),d.setDate(d.getDate()+10));const M=e.find(O=>O.address===p.gaugeAddress);u.push({power:p.nft_slopes.power,slope:p.nft_slopes.slope,end:p.nft_slopes.end,name:M.name,address:M.address,isUpdatable:!d||c.getTime()>d.getTime(),timeLeft:!d||c.getTime()>d.getTime()?0:`${Math.trunc((d.getTime()-c.getTime())/1e3/86400)} days`})});let g=[];return n.gaugesOptions.forEach(p=>{const w=u.find(d=>d.address===p.code);w?.power.toString()==="0"?g.push({...p,isUpdatable:w.isUpdatable,power:0}):g.splice(0,0,{...p,power:w?.power,locked:w?.timeLeft!==0,isUpdatable:w?.isUpdatable})}),{nftSlopes:u,gaugeOptionsFiltered:g,veCvgBalance:o,totalPowerUsed:y}}async getHistoryDataGauges(t,n){const e=await fetch(`https://api.cvg.finance//votes/history/${t}`),a=await e.json(),s=e.status;if(s===200){const i=[];return a.gaugeVotes.filter(o=>o.gauge_weight!=="0").forEach(o=>{let y=n.gaugesOptions.find(u=>u.code===o.gauge_address)?.display;i.push({weight:N(BigInt(o.gauge_weight),18),name:y,percent:E(o.percentage*100),percentRaw:o.percentage*100,address:o.gauge_address})}),i.sort((o,y)=>o.weight<y.weight)}else{if(s===400)throw a.error;if(s===500)throw a.error}}async voteGauge(t,n,e,a){const{gaugeController:s}=await r.getStaticData();return await new m(s,T.abi,a).simple_vote(t,n,e)}async voteGaugeMultiple(t,n){const{gaugeController:e}=await r.getStaticData();return await new m(e,T.abi,n).multi_vote(t)}}const ot=new st;class ut{bcService=new P;async getStaticData(t,n){const e=await r.getStaticData(),a={},s=await Y.getStaticData(e.cvgRewards);a.lastUpdatedTimestamp=s.lastUpdatedTimestamp,a.currentCycle=n,a.cvgToken=e.cvgToken,a.lockingPositionManager=e.lockingPositionManager,a.lockingPositionService=e.lockingPositionService;const i=await R.getActualCvgPrice(),o=await ot.getHeaderData(n,i);return t&&(a.walletData=await $.refreshTokenInfos(t,{token:e.cvgToken,contract:e.lockingPositionService}),a.walletData.lockAllowance=a.walletData.allowance[e.lockingPositionService],a.positions=await this.getLockingPositionList(t)),{...a,...o}}async getHeaderData(t){const n=await r.getStaticData(),e=new A,a=(t/12n+1n)*12n,s={};return e.addDefaultProcessValueFunc(S(s)),e.addCall("totalSupplyOfYsCvgAt",[a],["ysTotalSupply"],n.lockingPositionService),e.addCall("total_supply",void 0,["veTotalSupply"],n.votingPowerEscrow,1),e.addCall("lastUpdatedTimestamp",void 0,["lastUpdatedTimestamp"],n.cvgRewards,2),e.abis.push(k.abi),e.abis.push(x.abi),e.abis.push(_.abi),await I(e,await this.bcService.getStaticProvider()),s}async getFullVeLockingPositionList(t){const e=await(await this._getLockManagerContract()).getTokenIdsForWallet(t);let a=[];if(e?.length>0){const s=await this._getLockServiceContract(),i=e.map(o=>s.tokenInfos(o));a=await Promise.all(i)}return a.filter(s=>s.ysPercentage===0n).map(s=>s.toObject())}async getLockingPositionList(t){const e=await(await this._getLockManagerContract()).getTokenIdsForWallet(t);let a=[];return e?.length>0&&(a=await this.getPositionsInfo(e)),a=await this._addActualYsToPosition(a),a}async _addActualYsToPosition(t){const n=Number(await r.getActualCycle()),e=n%12,a=n+12-e,s=await this._getLockServiceContract();return await Promise.all(t.map(i=>{delete i.ysActual,s.balanceOfYsCvgAt(i.tokenId,a).then(o=>i.ysActual=o)})),t}async _getLockServiceContract(t=void 0){t=t||await this.bcService.getStaticProvider();const e=(await r.getStaticData())?.lockingPositionService;if(!e)throw new Error("No contract address found for LockingPositionService");return new m(e,k.abi,t)}async _getLockManagerContract(t=void 0){t=t||await this.bcService.getStaticProvider();const e=(await r.getStaticData())?.lockingPositionManager;if(!e)throw new Error("No contract address found for LockingPositionManager");return new m(e,L.abi,t)}async _getLockDelegateContract(t=void 0){t=t||await this.bcService.getStaticProvider();const e=(await r.getStaticData())?.lockingPositionDelegate;if(!e)throw new Error("No contract address found for lockingPositionDelegate");return new m(e,Z.abi,t)}async doCreateLock(t,n,e,a){const s=await this._getLockServiceContract(a),i=await a.getAddress();return await s.mintPosition(e,t,n,i,!0)}async increaseAmount(t,n,e){const a=await this._getLockServiceContract(e),s=await e.getAddress();return await a.increaseLockAmount(t,n,s)}async increaseTime(t,n,e){return await(await this._getLockServiceContract(e)).increaseLockTime(t,n)}async increaseTimeAmount(t,n,e,a){const s=await this._getLockServiceContract(a),i=await a.getAddress();return await s.increaseLockTimeAndAmount(t,e,n,i)}async burnPosition(t,n){return await(await this._getLockServiceContract(n)).burnPosition(t)}async getPositionsInfo(t,n=!1){if(!t||t.length===0)return[];const e=await this._getLockManagerContract(),a=await this._getLockServiceContract();return Promise.all(t.map(async i=>{let o=(await a.tokenInfos(i)).toObject(),y=await this.getDelegations(i);if(n){const u=await e.ownerOf(i);o={...o,owner:u}}return{tokenId:Number(i),...o,delegatedInfo:y}}))}async getDelegations(t){const n={tokenId:t},e=[async()=>n.ysCvg=await this._getDelegatedYsCvg(t),async()=>n.mgCvg=await this._getDelegatedMgCvg(t),async()=>n.veCVG=await this._getDelegatedVeCvg(t)];return await Promise.all(e.map(a=>a())),n}async _getDelegatedMgCvg(t){return await(await this._getLockDelegateContract()).getDelegatedMgCvg(t)}async _getDelegatedYsCvg(t){const e=await(await this._getLockDelegateContract()).delegatedYsCvg(t);return e===b?null:e}async _getDelegatedVeCvg(t){const e=await(await this._getLockDelegateContract()).delegatedVeCvg(t);return e===b?null:e}async doDelegateMg(t,n,e,a){const s={delegatee:n,percentage:e};return await(await this._getLockDelegateContract(a)).delegateMgCvg(t,[s])}async doRevokeMg(t,n,e){const a=await this._getLockDelegateContract(e),s={delegatee:n,percentage:0n};return await a.delegateMgCvg(t,[s])}async doDelegateYs(t,n,e){return await(await this._getLockDelegateContract(e)).delegateYsCvg(t,n)}async doRevokeYs(t,n,e){return await this.doDelegateYs(t,b,e)}async doDelegateVe(t,n,e){return await(await this._getLockDelegateContract(e)).delegateVeCvg(t,n)}async doRevokeVe(t,n){return await(await this._getLockDelegateContract(n)).cleanDelegatees(t,!0,!1)}async getDelegatess(t){const n={},e=[async()=>n.veCvg=await this._getDelegateesVeCvg(t),async()=>n.mgCvg=await this._getDelegateesMgCvg(t),async()=>n.getTokenOwnedAndDelegated=await this.getTokenOwnedAndDelegated(t),async()=>n.votingPower=await this._getVotingPower(t)];await Promise.all(e.map(i=>i()));const a=[];["owneds","mgDelegateds","veDelegateds"].forEach(i=>{n?.getTokenOwnedAndDelegated[i].forEach(o=>{a.find(y=>y.toString()===o.toString())||a.push(o)})}),["ysCvg","veCvg","mgCvg"].forEach(i=>{n[i]?.forEach(o=>{a.find(y=>y.toString()===o.toString())||a.push(o)})});const s=await this.getPositionsInfo(a,!0);return n.veCvgPosition=s.filter(i=>n.veCvg?.find(o=>o.toString()===i.tokenId.toString())),n.mgCvgPosition=s.filter(i=>n.mgCvg?.find(o=>o.toString()===i.tokenId.toString())),n.ysCvgPosition=s.filter(i=>n.ysCvg?.find(o=>o.toString()===i.tokenId.toString())),delete n.veCvg,delete n.mgCvg,delete n.ysCvg,n}async _getVotingPower(t){const n=await this._getLockServiceContract(),e={},a=[async()=>e.mgCvg=await n?.mgCvgVotingPowerPerAddress(t),async()=>e.veCvg=await n?.veCvgVotingPowerPerAddress(t)];return await Promise.all(a.map(s=>s())),e}async getTokenOwnedAndDelegated(t){return(await(await this._getLockDelegateContract()).getTokenOwnedAndDelegated(t)).toObject()}async _getDelegateesVeCvg(t){return await(await this._getLockDelegateContract())?.getVeCvgDelegatees(t)}async _getDelegateesMgCvg(t){return await(await this._getLockDelegateContract())?.getMgCvgDelegatees(t)}async validatePower(t,n,e,a){const s={owneds:t,mgDelegateds:e,veDelegateds:n};return await(await this._getLockDelegateContract(a))?.manageOwnedAndDelegated(s)}async revokeDelegatee(t,n,e,a){return await(await this._getLockDelegateContract(a))?.removeTokenIdDelegated(t,n,e)}}const pt=new ut,yt=pt;export{yt as l,ot as s};
