import{r as c,$ as X,G as Z,e as i0,a0 as s0,j as e,b as u0,a1 as Y,B as _0,s as J,d as Q,a2 as X0,a3 as b0,a4 as q0,a5 as e0,a6 as L0,a7 as l0,n as k,Y as $,h as G0,S as Y0,a8 as k0,O as t0,x as v0,l as H0,T as W0,k as W,a9 as N0,aa as S0,ab as A0,p as U,ac as I0,ad as m0,ae as U0,af as M0,f as K0,ag as R0,_ as z0}from"./index-614b6d1c.js";import{K as a0}from"./KeyValueDisplay-ec59a4c2.js";import{P as Z0,a as J0}from"./PageHelp-3dfbb5e1.js";import{s as H}from"./claim.stakedao.service-b2494336.js";import{s as D0}from"./staking.convex.service-49185c18.js";import{g as Q0}from"./convexUtils-7f054622.js";import{s as ee}from"./staking.convex.service-00231db1.js";import{H as g0}from"./HeaderInfoPanelContainer-15db6aee.js";import{E as O0}from"./ErrorDisplay-8be22464.js";import{W as c0}from"./WalletConnectedButton-5c407b26.js";import{I as o0}from"./InfoCircle-1ebdcaad.js";import{s as te}from"./staking.stakedao.service-87aa0857.js";import{S as P0}from"./Slippage-d86a5baa.js";import{V as ae}from"./ValueConnectedButton-ea3b8760.js";import{s as n0}from"./ysCvgClaim.service-bbde5ab6.js";import"./stakeDaoUtils-f752dab6.js";import"./CvxAssetStakingService-f8fb6638.js";import"./CurvePool-852682be.js";import"./convexStaking-08fe3d07.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},s=new Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="32bb6288-c564-4471-8d7d-df7def4a7445",t._sentryDebugIdIdentifier="sentry-dbid-32bb6288-c564-4471-8d7d-df7def4a7445")}catch{}})();const F=c.createContext(null);function ne({children:t}){const{address:s,getSigner:n,isWellConnected:a}=X(),[i,o]=c.useState(void 0),[l,r]=c.useState(void 0),[d,f]=c.useState(void 0),[u,x]=c.useState(!1),{handleTransaction:h,notifyError:C}=c.useContext(Z),{cvgPrice:w}=c.useContext(i0),S=()=>{if(!(i===void 0||d===void 0||i?.loading||d?.loading))return H.processTotals(i,d)},M=c.useMemo(S,[i,d]);c.useEffect(()=>{a&&i===void 0&&!i?.loading&&s&&A().then()},[i,s,a]),c.useEffect(()=>{l!==void 0&&d===void 0&&D().then()},[l,d]);const N=()=>{o(void 0)},A=async()=>{await s0(async()=>H.getRewards(s),T=>{o(T.result),r(T.rewardTokens)})},D=async()=>{await s0(async()=>({...await u0.getPrices(l),cvg:w}),f)},B=j=>i?Object.entries(i).filter(([,g])=>g.type===j).map(([,g])=>g):null,P=()=>{let j=[],g=0,T=[];return Object.values(i).forEach(async R=>{const v={stakingContract:R.stakingContract,tokenIds:R.tokenIds};g+=R.cvgAmount,R.rawData.forEach(b=>{T.push(...b.rewards.map(p=>p.token))}),j.push(v)}),g>0&&T.push("cvg"),{cvgAmount:g,allLines:j,rewardsToken:[...new Set(T)]}},G={rewardData:i,getDataByType:B,rewardPrice:d,totals:M,doClaim:async(j,g,T)=>{if(j.tokenIds?.length===1){await Y(async()=>await H.claimCvgSdtRewards(j.tokenIds?.at(0),j.stakingContract,g,T,await n()),N,h,C);return}await Y(async()=>{const v=Object.entries(j.rewardsByToken).reduce((b,[p,m])=>(b[p]=m,b),{});return await H.claimRewards(v,g,j.stakingContract,T,await n())},N,h,C)},advancedMode:u,setAdvancedMode:x,resetRewardsInfo:N,doClaimAll:async()=>{await Y(async()=>{const{allLines:g,rewardsToken:T}=P();return await H.claimRewardsMultiContract(g,!1,0,T,await n())},N,h,C)}};return e.jsx(F.Provider,{value:G,children:t})}const se="hh-sol-artifact-1",ie="StakingServiceBase",le="contracts/Staking/Convex/StakingServiceBase.sol",ce=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"}],name:"ClaimCvgCvxMultiple",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"}],name:"ClaimCvgMultiple",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"cycleId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rewardAmount",type:"uint256"}],name:"CvgCycleProcess",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"uint256",name:"cycleId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"cycleId",type:"uint256"},{indexed:!1,internalType:"address",name:"operator",type:"address"},{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],indexed:!1,internalType:"struct ICommonStruct.TokenAmount[]",name:"tokenAmounts",type:"tuple[]"}],name:"ProcessCvxRewards",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"uint256",name:"cycleId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Withdraw",type:"event"},{inputs:[],name:"CVG",outputs:[{internalType:"contract ICvg",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"acceptOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"accountInfoByCycle",outputs:[{internalType:"uint256",name:"amountStaked",type:"uint256"},{internalType:"uint256",name:"pendingStaked",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"address",name:"_spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowances",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"asset",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"buffer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"}],name:"claimCvgCvxMultiple",outputs:[{internalType:"uint256",name:"",type:"uint256"},{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ICommonStruct.TokenAmount[]",name:"",type:"tuple[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"_minCvgCvxAmountOut",type:"uint256"},{internalType:"bool",name:"_isConvert",type:"bool"}],name:"claimCvgCvxRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"claimCvgRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cvgControlTower",outputs:[{internalType:"contract ICvgControlTowerV2",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvxRewardDistributor",outputs:[{internalType:"contract ICvxRewardDistributor",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"}],name:"cvxRewardsByCycle",outputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"cycleInfo",outputs:[{internalType:"uint256",name:"cvgRewardsAmount",type:"uint256"},{internalType:"uint256",name:"totalStaked",type:"uint256"},{internalType:"bool",name:"isCvxProcessed",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"depositPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getAllClaimableAmounts",outputs:[{internalType:"uint256",name:"",type:"uint256"},{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ICommonStruct.TokenAmount[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getClaimableCyclesAndAmounts",outputs:[{components:[{internalType:"uint256",name:"cycleClaimable",type:"uint256"},{internalType:"uint256",name:"cvgRewards",type:"uint256"},{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ICommonStruct.TokenAmount[]",name:"cvxRewards",type:"tuple[]"}],internalType:"struct StakingServiceBase.ClaimableCyclesAndAmounts[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getHistoryLengthForAccount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"cycleId",type:"uint256"}],name:"getProcessedCvxRewards",outputs:[{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ICommonStruct.TokenAmount[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"nextClaims",outputs:[{internalType:"uint128",name:"nextClaimableCvg",type:"uint128"},{internalType:"uint128",name:"nextClaimableCvx",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[],name:"numberOfUnderlyingRewards",outputs:[{internalType:"uint128",name:"",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"poolEthInfo",outputs:[{internalType:"enum IStakingServiceBase.PoolType",name:"poolType",type:"uint8"},{internalType:"contract ICrvPool",name:"poolCurve",type:"address"},{internalType:"uint88",name:"fee",type:"uint88"},{internalType:"address",name:"token",type:"address"},{internalType:"uint96",name:"indexEth",type:"uint96"}],stateMutability:"view",type:"function"},{inputs:[],name:"processCvxRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"processStakersRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_buffer",type:"address"}],name:"setBuffer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IStakingServiceBase.PoolType",name:"poolType",type:"uint8"},{internalType:"contract ICrvPool",name:"poolCurve",type:"address"},{internalType:"uint88",name:"fee",type:"uint88"},{internalType:"address",name:"token",type:"address"},{internalType:"uint96",name:"indexEth",type:"uint96"}],internalType:"struct IStakingServiceBase.PoolEthInfo",name:"_poolEthInfo",type:"tuple"}],name:"setPoolEthInfo",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_cycleId",type:"uint256"},{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"_actualCycle",type:"uint256"}],name:"stakedAmountEligibleAtCycle",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"stakingCycle",outputs:[{internalType:"uint128",name:"",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"stakingHistoryByAccount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"toggleDepositPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"",type:"address"}],name:"tokenToId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],h0={_format:se,contractName:ie,sourceName:le,abi:ce},oe="hh-sol-artifact-1",re="CvxRewardDistributor",de="contracts/Staking/Convex/CvxRewardDistributor.sol",fe=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"CVG",outputs:[{internalType:"contract ICvg",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"CVX",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"acceptOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"receiver",type:"address"},{internalType:"uint256",name:"totalCvgClaimable",type:"uint256"},{components:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ICommonStruct.TokenAmount[]",name:"totalCvxRewardsClaimable",type:"tuple[]"},{internalType:"uint256",name:"minCvgCvxAmountOut",type:"uint256"},{internalType:"bool",name:"isConvert",type:"bool"}],name:"claimCvgCvxSimple",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract ICvxStakingPositionService[]",name:"claimContracts",type:"address[]"},{internalType:"address",name:"_account",type:"address"},{internalType:"uint256",name:"_minCvgCvxAmountOut",type:"uint256"},{internalType:"bool",name:"_isConvert",type:"bool"},{internalType:"uint256",name:"cvxRewardCount",type:"uint256"}],name:"claimMultipleStaking",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cvgCVX",outputs:[{internalType:"contract ICvgCVX",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvgControlTower",outputs:[{internalType:"contract ICvgControlTowerV2",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"cvx1",outputs:[{internalType:"contract ICVX1",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract ICVX1",name:"_cvx1",type:"address"},{internalType:"contract ICvgCVX",name:"_cvgCVX",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"poolCvgCvxCvx1",outputs:[{internalType:"contract ICrvPoolPlain",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract ICrvPoolPlain",name:"_poolCvgCvxCvx1",type:"address"}],name:"setPoolCvgCvxCvx1AndApprove",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],ue="0x608060405234801561000f575f80fd5b5061001861001d565b6100d9565b5f54610100900460ff16156100885760405162461bcd60e51b815260206004820152602760248201527f496e697469616c697a61626c653a20636f6e747261637420697320696e697469604482015266616c697a696e6760c81b606482015260840160405180910390fd5b5f5460ff908116146100d7575f805460ff191660ff9081179091556040519081527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b565b611707806100e65f395ff3fe608060405234801561000f575f80fd5b50600436106100f0575f3560e01c806388f2cf7511610093578063ba183a0811610063578063ba183a08146101db578063bdbaa194146101ee578063e30c397814610209578063f2fde38b1461021a575f80fd5b806388f2cf75146101915780638da5cb5b146101a457806395eb10f1146101b5578063a92f26d6146101c8575f80fd5b8063506eacda116100ce578063506eacda14610153578063715018a614610166578063759cb53b1461016e57806379ba509714610189575f80fd5b806323446652146100f45780633882024b14610109578063485cc95514610140575b5f80fd5b610107610102366004611283565b61022d565b005b61012473b0afc8363b8f36e0cce5d54251e20720ffaeaee781565b6040516001600160a01b03909116815260200160405180910390f35b61010761014e366004611322565b6105ed565b6101076101613660046113ea565b61097c565b610107610a3b565b610124734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b81565b610107610a4e565b61010761019f3660046114dc565b610ac8565b6033546001600160a01b0316610124565b609854610124906001600160a01b031681565b609954610124906001600160a01b031681565b609754610124906001600160a01b031681565b6101247397effb790f2fbb701d88f89db4521348a2b77be881565b6065546001600160a01b0316610124565b6101076102283660046114dc565b610be7565b5f8590036102785760405162461bcd60e51b81526020600482015260136024820152721393d7d4d51052d25391d7d4d1531150d51151606a1b60448201526064015b60405180910390fd5b81156102d657336001600160a01b038516146102d65760405162461bcd60e51b815260206004820152601f60248201527f43414e545f434f4e564552545f4356585f464f525f4f544845525f5553455200604482015260640161026f565b5f808267ffffffffffffffff8111156102f1576102f1611359565b60405190808252806020026020018201604052801561033557816020015b604080518082019091525f808252602082015281526020019060019003908161030f5790505b5090505f5b878110156105d5575f898983818110610355576103556114fe565b905060200201602081019061036a91906114dc565b60405163011f20bf60e01b81526001600160a01b038a811660048301529192505f9182919084169063011f20bf906024015f604051808303815f875af11580156103b6573d5f803e3d5ffd5b505050506040513d5f823e601f3d908101601f191682016040526103dd9190810190611512565b90925090506103ec82876115e9565b81519096505f5b818110156105c55782818151811061040d5761040d6114fe565b6020026020010151602001515f146105bd575f5b898110156105bb575f88828151811061043c5761043c6114fe565b60209081029190910101515190506001600160a01b0381166104d2576040518060400160405280868581518110610475576104756114fe565b60200260200101515f01516001600160a01b031681526020018685815181106104a0576104a06114fe565b6020026020010151602001518152508983815181106104c1576104c16114fe565b6020026020010181905250506105bb565b8483815181106104e4576104e46114fe565b60200260200101515f01516001600160a01b0316816001600160a01b03160361055957848381518110610519576105196114fe565b602002602001015160200151898381518110610537576105376114fe565b602002602001015160200181815161054f91906115e9565b9052506105bb9050565b61056460018c611602565b82036105b25760405162461bcd60e51b815260206004820152601660248201527f5245574152445f434f554e545f544f4f5f534d414c4c00000000000000000000604482015260640161026f565b50600101610421565b505b6001016103f3565b508460010194505050505061033a565b506105e38683838888610c58565b5050505050505050565b5f54610100900460ff161580801561060b57505f54600160ff909116105b806106245750303b15801561062457505f5460ff166001145b6106875760405162461bcd60e51b815260206004820152602e60248201527f496e697469616c697a61626c653a20636f6e747261637420697320616c72656160448201526d191e481a5b9a5d1a585b1a5e995960921b606482015260840161026f565b5f805460ff1916600117905580156106a8575f805461ff0019166101001790555b5f73b0afc8363b8f36e0cce5d54251e20720ffaeaee76001600160a01b031663f4289aba6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156106f9573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061071d9190611615565b90506001600160a01b0383166107675760405162461bcd60e51b815260206004820152600f60248201526e4356585f4c4f434b45525f5a45524f60881b604482015260640161026f565b609780546001600160a01b0319166001600160a01b038581169190911790915584166107c15760405162461bcd60e51b8152602060048201526009602482015268435658315f5a45524f60b81b604482015260640161026f565b609980546001600160a01b0319166001600160a01b03861690811790915560405163095ea7b360e01b815260048101919091525f196024820152734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b9063095ea7b3906044016020604051808303815f875af1158015610836573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061085a9190611630565b5060405163095ea7b360e01b81526001600160a01b03841660048201525f196024820152734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b9063095ea7b3906044016020604051808303815f875af11580156108b9573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906108dd9190611630565b506001600160a01b0381166109285760405162461bcd60e51b815260206004820152601160248201527054524541535552595f44414f5f5a45524f60781b604482015260640161026f565b61093181610ed4565b508015610977575f805461ff0019169055604051600181527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b505050565b6040516306df271960e01b815233600482015273b0afc8363b8f36e0cce5d54251e20720ffaeaee7906306df271990602401602060405180830381865afa1580156109c9573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906109ed9190611630565b610a275760405162461bcd60e51b815260206004820152600b60248201526a4e4f545f5354414b494e4760a81b604482015260640161026f565b610a348585858585610c58565b5050505050565b610a43610eed565b610a4c5f610ed4565b565b60655433906001600160a01b03168114610abc5760405162461bcd60e51b815260206004820152602960248201527f4f776e61626c6532537465703a2063616c6c6572206973206e6f7420746865206044820152683732bb9037bbb732b960b91b606482015260840161026f565b610ac581610ed4565b50565b610ad0610eed565b6098546001600160a01b031615610b585760995460985460405163095ea7b360e01b81526001600160a01b0391821660048201525f602482015291169063095ea7b3906044016020604051808303815f875af1158015610b32573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610b569190611630565b505b609880546001600160a01b0319166001600160a01b0383811691821790925560995460405163095ea7b360e01b815260048101929092525f1960248301529091169063095ea7b3906044016020604051808303815f875af1158015610bbf573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610be39190611630565b5050565b610bef610eed565b606580546001600160a01b0383166001600160a01b03199091168117909155610c206033546001600160a01b031690565b6001600160a01b03167f38d16b8cac22d99fc7c124b9cd0de2d3fa1faef420bfe791d8c362d765e2270060405160405180910390a350565b8315610cce5760405163343028e760e01b81526001600160a01b0386166004820152602481018590527397effb790f2fbb701d88f89db4521348a2b77be89063343028e7906044015f604051808303815f87803b158015610cb7575f80fd5b505af1158015610cc9573d5f803e3d5ffd5b505050505b5f5b8351811015610ecc575f848281518110610cec57610cec6114fe565b60200260200101516020015190505f811115610ec357828015610d505750734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b6001600160a01b0316858381518110610d3a57610d3a6114fe565b60200260200101515f01516001600160a01b0316145b15610e8957835f03610ddd576097546040516334686fad60e21b81526001600160a01b038981166004830152602482018490525f60448301529091169063d1a1beb4906064015b6020604051808303815f875af1158015610db3573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610dd7919061164b565b50610ec3565b6099546040516340c10f1960e01b8152306004820152602481018390526001600160a01b03909116906340c10f19906044015f604051808303815f87803b158015610e26575f80fd5b505af1158015610e38573d5f803e3d5ffd5b505060985460405163ddc1f59d60e01b81525f60048201526001602482015260448101859052606481018890526001600160a01b038b81166084830152909116925063ddc1f59d915060a401610d97565b610ec38782878581518110610ea057610ea06114fe565b60200260200101515f01516001600160a01b0316610f479092919063ffffffff16565b50600101610cd0565b505050505050565b606580546001600160a01b0319169055610ac581610f99565b6033546001600160a01b03163314610a4c5760405162461bcd60e51b815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015260640161026f565b604080516001600160a01b038416602482015260448082018490528251808303909101815260649091019091526020810180516001600160e01b031663a9059cbb60e01b179052610977908490610fea565b603380546001600160a01b038381166001600160a01b0319831681179093556040519116919082907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0905f90a35050565b5f61103e826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564815250856001600160a01b03166110bd9092919063ffffffff16565b905080515f148061105e57508080602001905181019061105e9190611630565b6109775760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e6044820152691bdd081cdd58d8d9595960b21b606482015260840161026f565b60606110cb84845f856110d3565b949350505050565b6060824710156111345760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f6044820152651c8818d85b1b60d21b606482015260840161026f565b5f80866001600160a01b0316858760405161114f9190611684565b5f6040518083038185875af1925050503d805f8114611189576040519150601f19603f3d011682016040523d82523d5f602084013e61118e565b606091505b509150915061119f878383876111aa565b979650505050505050565b606083156112185782515f03611211576001600160a01b0385163b6112115760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015260640161026f565b50816110cb565b6110cb838381511561122d5781518083602001fd5b8060405162461bcd60e51b815260040161026f919061169f565b6001600160a01b0381168114610ac5575f80fd5b803561126681611247565b919050565b8015158114610ac5575f80fd5b80356112668161126b565b5f805f805f8060a08789031215611298575f80fd5b863567ffffffffffffffff808211156112af575f80fd5b818901915089601f8301126112c2575f80fd5b8135818111156112d0575f80fd5b8a60208260051b85010111156112e4575f80fd5b6020928301985096506112fa918901905061125b565b93506040870135925061130f60608801611278565b9150608087013590509295509295509295565b5f8060408385031215611333575f80fd5b823561133e81611247565b9150602083013561134e81611247565b809150509250929050565b634e487b7160e01b5f52604160045260245ffd5b6040805190810167ffffffffffffffff8111828210171561139057611390611359565b60405290565b604051601f8201601f1916810167ffffffffffffffff811182821017156113bf576113bf611359565b604052919050565b5f67ffffffffffffffff8211156113e0576113e0611359565b5060051b60200190565b5f805f805f60a086880312156113fe575f80fd5b853561140981611247565b9450602086810135945060408088013567ffffffffffffffff81111561142d575f80fd5b8801601f81018a1361143d575f80fd5b803561145061144b826113c7565b611396565b81815260069190911b8201840190848101908c83111561146e575f80fd5b928501925b828410156114b55784848e031215611489575f80fd5b61149161136d565b843561149c81611247565b8152848701358782015282529284019290850190611473565b9750505050606088013593506114d091505060808701611278565b90509295509295909350565b5f602082840312156114ec575f80fd5b81356114f781611247565b9392505050565b634e487b7160e01b5f52603260045260245ffd5b5f806040808486031215611524575f80fd5b8351925060208085015167ffffffffffffffff811115611542575f80fd5b8501601f81018713611552575f80fd5b805161156061144b826113c7565b81815260069190911b8201830190838101908983111561157e575f80fd5b928401925b828410156115c55785848b031215611599575f80fd5b6115a161136d565b84516115ac81611247565b8152848601518682015282529285019290840190611583565b8096505050505050509250929050565b634e487b7160e01b5f52601160045260245ffd5b808201808211156115fc576115fc6115d5565b92915050565b818103818111156115fc576115fc6115d5565b5f60208284031215611625575f80fd5b81516114f781611247565b5f60208284031215611640575f80fd5b81516114f78161126b565b5f6020828403121561165b575f80fd5b5051919050565b5f5b8381101561167c578181015183820152602001611664565b50505f910152565b5f8251611695818460208701611662565b9190910192915050565b602081525f82518060208401526116bd816040850160208701611662565b601f01601f1916919091016040019291505056fea2646970667358221220659ea0a9ed44c065693e38bdf9dde5cf9d7dcce132de8b5b5b2451ede355101064736f6c63430008180033",be="0x608060405234801561000f575f80fd5b50600436106100f0575f3560e01c806388f2cf7511610093578063ba183a0811610063578063ba183a08146101db578063bdbaa194146101ee578063e30c397814610209578063f2fde38b1461021a575f80fd5b806388f2cf75146101915780638da5cb5b146101a457806395eb10f1146101b5578063a92f26d6146101c8575f80fd5b8063506eacda116100ce578063506eacda14610153578063715018a614610166578063759cb53b1461016e57806379ba509714610189575f80fd5b806323446652146100f45780633882024b14610109578063485cc95514610140575b5f80fd5b610107610102366004611283565b61022d565b005b61012473b0afc8363b8f36e0cce5d54251e20720ffaeaee781565b6040516001600160a01b03909116815260200160405180910390f35b61010761014e366004611322565b6105ed565b6101076101613660046113ea565b61097c565b610107610a3b565b610124734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b81565b610107610a4e565b61010761019f3660046114dc565b610ac8565b6033546001600160a01b0316610124565b609854610124906001600160a01b031681565b609954610124906001600160a01b031681565b609754610124906001600160a01b031681565b6101247397effb790f2fbb701d88f89db4521348a2b77be881565b6065546001600160a01b0316610124565b6101076102283660046114dc565b610be7565b5f8590036102785760405162461bcd60e51b81526020600482015260136024820152721393d7d4d51052d25391d7d4d1531150d51151606a1b60448201526064015b60405180910390fd5b81156102d657336001600160a01b038516146102d65760405162461bcd60e51b815260206004820152601f60248201527f43414e545f434f4e564552545f4356585f464f525f4f544845525f5553455200604482015260640161026f565b5f808267ffffffffffffffff8111156102f1576102f1611359565b60405190808252806020026020018201604052801561033557816020015b604080518082019091525f808252602082015281526020019060019003908161030f5790505b5090505f5b878110156105d5575f898983818110610355576103556114fe565b905060200201602081019061036a91906114dc565b60405163011f20bf60e01b81526001600160a01b038a811660048301529192505f9182919084169063011f20bf906024015f604051808303815f875af11580156103b6573d5f803e3d5ffd5b505050506040513d5f823e601f3d908101601f191682016040526103dd9190810190611512565b90925090506103ec82876115e9565b81519096505f5b818110156105c55782818151811061040d5761040d6114fe565b6020026020010151602001515f146105bd575f5b898110156105bb575f88828151811061043c5761043c6114fe565b60209081029190910101515190506001600160a01b0381166104d2576040518060400160405280868581518110610475576104756114fe565b60200260200101515f01516001600160a01b031681526020018685815181106104a0576104a06114fe565b6020026020010151602001518152508983815181106104c1576104c16114fe565b6020026020010181905250506105bb565b8483815181106104e4576104e46114fe565b60200260200101515f01516001600160a01b0316816001600160a01b03160361055957848381518110610519576105196114fe565b602002602001015160200151898381518110610537576105376114fe565b602002602001015160200181815161054f91906115e9565b9052506105bb9050565b61056460018c611602565b82036105b25760405162461bcd60e51b815260206004820152601660248201527f5245574152445f434f554e545f544f4f5f534d414c4c00000000000000000000604482015260640161026f565b50600101610421565b505b6001016103f3565b508460010194505050505061033a565b506105e38683838888610c58565b5050505050505050565b5f54610100900460ff161580801561060b57505f54600160ff909116105b806106245750303b15801561062457505f5460ff166001145b6106875760405162461bcd60e51b815260206004820152602e60248201527f496e697469616c697a61626c653a20636f6e747261637420697320616c72656160448201526d191e481a5b9a5d1a585b1a5e995960921b606482015260840161026f565b5f805460ff1916600117905580156106a8575f805461ff0019166101001790555b5f73b0afc8363b8f36e0cce5d54251e20720ffaeaee76001600160a01b031663f4289aba6040518163ffffffff1660e01b8152600401602060405180830381865afa1580156106f9573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061071d9190611615565b90506001600160a01b0383166107675760405162461bcd60e51b815260206004820152600f60248201526e4356585f4c4f434b45525f5a45524f60881b604482015260640161026f565b609780546001600160a01b0319166001600160a01b038581169190911790915584166107c15760405162461bcd60e51b8152602060048201526009602482015268435658315f5a45524f60b81b604482015260640161026f565b609980546001600160a01b0319166001600160a01b03861690811790915560405163095ea7b360e01b815260048101919091525f196024820152734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b9063095ea7b3906044016020604051808303815f875af1158015610836573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061085a9190611630565b5060405163095ea7b360e01b81526001600160a01b03841660048201525f196024820152734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b9063095ea7b3906044016020604051808303815f875af11580156108b9573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906108dd9190611630565b506001600160a01b0381166109285760405162461bcd60e51b815260206004820152601160248201527054524541535552595f44414f5f5a45524f60781b604482015260640161026f565b61093181610ed4565b508015610977575f805461ff0019169055604051600181527f7f26b83ff96e1f2b6a682f133852f6798a09c465da95921460cefb38474024989060200160405180910390a15b505050565b6040516306df271960e01b815233600482015273b0afc8363b8f36e0cce5d54251e20720ffaeaee7906306df271990602401602060405180830381865afa1580156109c9573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906109ed9190611630565b610a275760405162461bcd60e51b815260206004820152600b60248201526a4e4f545f5354414b494e4760a81b604482015260640161026f565b610a348585858585610c58565b5050505050565b610a43610eed565b610a4c5f610ed4565b565b60655433906001600160a01b03168114610abc5760405162461bcd60e51b815260206004820152602960248201527f4f776e61626c6532537465703a2063616c6c6572206973206e6f7420746865206044820152683732bb9037bbb732b960b91b606482015260840161026f565b610ac581610ed4565b50565b610ad0610eed565b6098546001600160a01b031615610b585760995460985460405163095ea7b360e01b81526001600160a01b0391821660048201525f602482015291169063095ea7b3906044016020604051808303815f875af1158015610b32573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610b569190611630565b505b609880546001600160a01b0319166001600160a01b0383811691821790925560995460405163095ea7b360e01b815260048101929092525f1960248301529091169063095ea7b3906044016020604051808303815f875af1158015610bbf573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610be39190611630565b5050565b610bef610eed565b606580546001600160a01b0383166001600160a01b03199091168117909155610c206033546001600160a01b031690565b6001600160a01b03167f38d16b8cac22d99fc7c124b9cd0de2d3fa1faef420bfe791d8c362d765e2270060405160405180910390a350565b8315610cce5760405163343028e760e01b81526001600160a01b0386166004820152602481018590527397effb790f2fbb701d88f89db4521348a2b77be89063343028e7906044015f604051808303815f87803b158015610cb7575f80fd5b505af1158015610cc9573d5f803e3d5ffd5b505050505b5f5b8351811015610ecc575f848281518110610cec57610cec6114fe565b60200260200101516020015190505f811115610ec357828015610d505750734e3fbd56cd56c3e72c1403e103b45db9da5b9d2b6001600160a01b0316858381518110610d3a57610d3a6114fe565b60200260200101515f01516001600160a01b0316145b15610e8957835f03610ddd576097546040516334686fad60e21b81526001600160a01b038981166004830152602482018490525f60448301529091169063d1a1beb4906064015b6020604051808303815f875af1158015610db3573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610dd7919061164b565b50610ec3565b6099546040516340c10f1960e01b8152306004820152602481018390526001600160a01b03909116906340c10f19906044015f604051808303815f87803b158015610e26575f80fd5b505af1158015610e38573d5f803e3d5ffd5b505060985460405163ddc1f59d60e01b81525f60048201526001602482015260448101859052606481018890526001600160a01b038b81166084830152909116925063ddc1f59d915060a401610d97565b610ec38782878581518110610ea057610ea06114fe565b60200260200101515f01516001600160a01b0316610f479092919063ffffffff16565b50600101610cd0565b505050505050565b606580546001600160a01b0319169055610ac581610f99565b6033546001600160a01b03163314610a4c5760405162461bcd60e51b815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015260640161026f565b604080516001600160a01b038416602482015260448082018490528251808303909101815260649091019091526020810180516001600160e01b031663a9059cbb60e01b179052610977908490610fea565b603380546001600160a01b038381166001600160a01b0319831681179093556040519116919082907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0905f90a35050565b5f61103e826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564815250856001600160a01b03166110bd9092919063ffffffff16565b905080515f148061105e57508080602001905181019061105e9190611630565b6109775760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e6044820152691bdd081cdd58d8d9595960b21b606482015260840161026f565b60606110cb84845f856110d3565b949350505050565b6060824710156111345760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f6044820152651c8818d85b1b60d21b606482015260840161026f565b5f80866001600160a01b0316858760405161114f9190611684565b5f6040518083038185875af1925050503d805f8114611189576040519150601f19603f3d011682016040523d82523d5f602084013e61118e565b606091505b509150915061119f878383876111aa565b979650505050505050565b606083156112185782515f03611211576001600160a01b0385163b6112115760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015260640161026f565b50816110cb565b6110cb838381511561122d5781518083602001fd5b8060405162461bcd60e51b815260040161026f919061169f565b6001600160a01b0381168114610ac5575f80fd5b803561126681611247565b919050565b8015158114610ac5575f80fd5b80356112668161126b565b5f805f805f8060a08789031215611298575f80fd5b863567ffffffffffffffff808211156112af575f80fd5b818901915089601f8301126112c2575f80fd5b8135818111156112d0575f80fd5b8a60208260051b85010111156112e4575f80fd5b6020928301985096506112fa918901905061125b565b93506040870135925061130f60608801611278565b9150608087013590509295509295509295565b5f8060408385031215611333575f80fd5b823561133e81611247565b9150602083013561134e81611247565b809150509250929050565b634e487b7160e01b5f52604160045260245ffd5b6040805190810167ffffffffffffffff8111828210171561139057611390611359565b60405290565b604051601f8201601f1916810167ffffffffffffffff811182821017156113bf576113bf611359565b604052919050565b5f67ffffffffffffffff8211156113e0576113e0611359565b5060051b60200190565b5f805f805f60a086880312156113fe575f80fd5b853561140981611247565b9450602086810135945060408088013567ffffffffffffffff81111561142d575f80fd5b8801601f81018a1361143d575f80fd5b803561145061144b826113c7565b611396565b81815260069190911b8201840190848101908c83111561146e575f80fd5b928501925b828410156114b55784848e031215611489575f80fd5b61149161136d565b843561149c81611247565b8152848701358782015282529284019290850190611473565b9750505050606088013593506114d091505060808701611278565b90509295509295909350565b5f602082840312156114ec575f80fd5b81356114f781611247565b9392505050565b634e487b7160e01b5f52603260045260245ffd5b5f806040808486031215611524575f80fd5b8351925060208085015167ffffffffffffffff811115611542575f80fd5b8501601f81018713611552575f80fd5b805161156061144b826113c7565b81815260069190911b8201830190838101908983111561157e575f80fd5b928401925b828410156115c55785848b031215611599575f80fd5b6115a161136d565b84516115ac81611247565b8152848601518682015282529285019290840190611583565b8096505050505050509250929050565b634e487b7160e01b5f52601160045260245ffd5b808201808211156115fc576115fc6115d5565b92915050565b818103818111156115fc576115fc6115d5565b5f60208284031215611625575f80fd5b81516114f781611247565b5f60208284031215611640575f80fd5b81516114f78161126b565b5f6020828403121561165b575f80fd5b5051919050565b5f5b8381101561167c578181015183820152602001611664565b50505f910152565b5f8251611695818460208701611662565b9190910192915050565b602081525f82518060208401526116bd816040850160208701611662565b601f01601f1916919091016040019291505056fea2646970667358221220659ea0a9ed44c065693e38bdf9dde5cf9d7dcce132de8b5b5b2451ede355101064736f6c63430008180033",me={},pe={},C0={_format:oe,contractName:re,sourceName:de,abi:fe,bytecode:ue,deployedBytecode:be,linkReferences:me,deployedLinkReferences:pe};class xe{bcService=new _0;async getRewards(s){const n=await J.getStaticData();let a=await ee.getList();a=a.filter(f=>f.key!=="CVX1");const i=a.map(async f=>{const u=await this.getAllClaimableAmounts(s,f.stakingContract);return{...await this._getCvxRewards(u),tokenId:f.stakingContract,stakingContract:f.stakingContract,logo:f?.logo,stakingName:f?.name||f?.stakingName,cvgRaw:u?.at(0),cvgAmount:Q(u?.at(0),18),rewards:await this._addErc20InfoToRewards(u),type:f?.type}}),o=await Promise.all(i),{rewardTokens:l,result:r,allCvx:d}=this._aggregateRewards(o?.flat(1),n.convex.cvx);return{rewardTokens:l,result:r,allCvx:d}}_aggregateRewards(s,n){const a=[],i=r=>{a.indexOf(r)===-1&&a.push(r)};let o=0n;const l={};return s.forEach(r=>{if(r.cvgAmount===0&&!r?.rewards?.length)return;l[r.stakingContract]?(l[r.stakingContract].cvgRaw+r.cvgRaw,l[r.stakingContract].cvgAmount+=r.cvgAmount,l[r.stakingContract].rewardsByToken[r.tokenId]=[]):l[r.stakingContract]={items:[],rawData:[],type:r.type,logo:r?.logo,stakingName:Q0(r.stakingName).name,tokenIds:[r.tokenId],rewardsByToken:{[r.tokenId]:[]},cvgRaw:r.cvgRaw,cvxRaw:0n,cvgCvxRatio:r.cvgCvxRatio,cvgAmount:r.cvgAmount,stakingContract:r.stakingContract};const d=l[r.stakingContract];d.cvgAmount>0&&d.rewardsByToken[r.tokenId].push("cvg"),r?.rewards?.forEach(f=>{f.tokenAddress===n&&(o+=f.amountRaw,l[r.stakingContract].cvxRaw+=f.amountRaw),i(f.tokenAddress);const u=d.items.find(x=>x.tokenAddress===f.tokenAddress);u?(u.amount+=f.amount,u.amountRaw=u.amountRaw+f.amountRaw):(d.items.push(f),d.rewardsByToken[r.tokenId].push(f.tokenAddress))}),d?.tokenIds?.indexOf(r.tokenId)===-1&&d.tokenIds.push(r.tokenId),d.rawData.push(r)}),{rewardTokens:a,result:l,allCvx:o}}_getCvxRewards=async s=>{const n=await J.getStaticData(),a=s?.at(1).find(o=>o.token===n.convex.cvx);let i=-1;return a&&a.amount>0n&&(i=await D0.getCvxCvgCvxRatio(a.amount)),{cvxRaw:a?.amount||0n,cvxAmount:Q(a?.amount||0n,18),cvgCvxRatio:i}};_addErc20InfoToRewards=async s=>{const n=s?.at(0),a=s?.at(1).filter(o=>o.token!==X0);let i=[];return n>0n&&i.push({token:"cvg",amount:Q(n,18),amountRaw:n,stakingName:"cvxCVG",logo:b0}),a&&(i=a.map(async o=>{const l=await q0.getErc20INfo(o.token);return{...l,amount:Q(o.amount,l?.decimals),amountRaw:o.amount}})),await Promise.all(i)};async getAllClaimableAmounts(s,n){return await new e0(n,h0.abi,await this.bcService.getStaticProvider()).getAllClaimableAmounts(s)}processTotals(s,n){const a={cvgAsset:{other:0,cvg:0,usd:0},cvxAsset:{usd:0,cvg:0,other:0},sd:{usd:0,cvg:0,other:0},usd:0,tokens:{}};return Object.values(s).map(i=>{i.items.map(async o=>{const l=n[o.tokenAddress]||0;a[i.type].usd+=o.amount*l,a.usd+=o.amount*l,a.tokens[o.tokenAddress]||(a.tokens[o.tokenAddress]={amount:0,usd:0}),a.tokens[o.tokenAddress].amount+=o.amount,a.tokens[o.tokenAddress].usd+=o.amount*l,a[i.type].other+=o.amount*l})}),a}async claimRewardsMultiContract(s,n,a,i,o,l){const r=await J.getStaticData();return await new e0(r?.convex.cvxRewardDistributor,C0.abi,l).claimMultipleStaking(n,s,i,a,o?.length)}async claimCvgCvxRewards(s,n,a,i,o){return await new e0(n,h0.abi,o).claimCvgCvxRewards(s,i,a)}async claimRewards(s,n,a,i,o){let l=[];const r=[...new Set(l)].length,d=await J.getStaticData(),f=new e0(d?.convex.cvxRewardDistributor,C0.abi,o);if(r===1&&l[0]==="cvg")throw new Error("Cvg only not claimable at the moment ");return await f.claimMultipleStaking([a],s,i,n,r)}async getTotalClaimable(s,n){const{rewardTokens:a,result:i}=await this.getRewards(s);if(!Object.keys(i)?.length)return 0;const o=await u0.getPrices(a),l={total:{claimable:0},sd:{claimable:0},lp:{claimable:0},cvgAsset:{claimable:0},contracts:{}},r=d=>(l.contracts[d]||(l.contracts[d]={claimable:0}),l.contracts[d]);return Object.values(i).forEach(d=>{const f=r(d.stakingContract);f.claimable+=d.cvgAmount*n,d.items.forEach(u=>{f.claimable+=u.amount*(o[u.tokenAddress]||0)}),l.total.claimable+=f.claimable,l[d.type].claimable+=f.claimable}),l}}const K=new xe,q=c.createContext(null);function ye({children:t}){const{address:s,getSigner:n,isWellConnected:a}=X(),[i,o]=c.useState(void 0),[l,r]=c.useState(void 0),[d,f]=c.useState(void 0),[u,x]=c.useState(!1),{handleTransaction:h,notifyError:C}=c.useContext(Z),{cvgPrice:w}=c.useContext(i0),S=()=>{if(!(i===void 0||d===void 0||i?.loading||d?.loading))return K.processTotals(i,d)},M=c.useMemo(S,[i,d]);c.useEffect(()=>{a&&i===void 0&&!i?.loading&&s&&A().then()},[i,s,a]),c.useEffect(()=>{l!==void 0&&d===void 0&&D().then()},[l,d]);const N=()=>{o(void 0)},A=async()=>{await s0(async()=>K.getRewards(s),T=>{o(T.result),r(T.rewardTokens)})},D=async()=>{await s0(async()=>({...await u0.getPrices(l),cvg:w}),f)},B=j=>i?Object.entries(i).filter(([,g])=>g.type===j).map(([,g])=>g):null,P=()=>{let j=[],g=0,T=[];return Object.values(i).forEach(async R=>{g+=R.cvgAmount,R.rawData.forEach(v=>{T.push(...v.rewards.map(b=>b.token))}),j.push(R.stakingContract)}),g>0&&T.push("cvg"),{cvgAmount:g,allLines:j,rewardsToken:[...new Set(T)]}},G={rewardData:i,getDataByType:B,rewardPrice:d,totals:M,doClaim:async(j,g,T)=>{await Y(async()=>await K.claimCvgCvxRewards(s,j.stakingContract,g,T,await n()),N,h,C)},advancedMode:u,setAdvancedMode:x,resetRewardsInfo:N,doClaimAll:async()=>{await Y(async()=>{const{allLines:g,rewardsToken:T}=P();return await K.claimRewardsMultiContract(s,g,!1,0,T,await n())},N,h,C)}};return e.jsx(q.Provider,{value:G,children:t})}function ve(){const{nextDistributionDurations:t,actualCycle:s}=c.useContext(i0),{isWellConnected:n}=X(),{totals:a}=c.useContext(F),{totals:i}=c.useContext(q),o=()=>{if(!n)return e.jsx(L0,{});if(a===void 0&&i===void 0)return e.jsx(e.Fragment,{children:[0,0,0,0].map((r,d)=>e.jsx(l0,{className:"w-10rem p-1 m-1"},d))});let l=0;return a?.usd!==void 0&&(l+=a?.usd),i?.usd!==void 0&&(l+=i?.usd),e.jsx(g0,{children:e.jsx(a0,{label:"Total claimable",value:`$${k(l)}`,className:"is-highlight"})})};return e.jsxs(Z0,{children:[e.jsxs(g0,{children:[e.jsx(J0,{title:"Claim info",children:"Claim rewards earned from all sections of the protocol."}),e.jsx(a0,{label:"Current Cycle",value:Number(s),className:"is-highlight"}),e.jsx(a0,{label:"Next CVG rewards",value:t?.data?.durationNextCvg,className:"is-highlight"}),e.jsx(a0,{label:"Next TDE",value:t?.data?.durationNextTde,className:"is-highlight"})]}),o()]})}function d0({type:t,title:s,children:n}){const{totals:a}=c.useContext(F),[i,o]=c.useState(!1),l=()=>o(!i),r=()=>({lp:G0,sd:Y0,cvgSdt:k0})[t],d=()=>a===void 0?e.jsx("div",{className:"flex-grow-1 flex justify-content-end flex-column lg:flex-row ",children:e.jsx(l0,{className:"w-10rem p-2"})}):e.jsx("div",{className:"flex-grow-1",children:e.jsx("span",{className:"flex align-items-start justify-content-end flex-column lg:flex-row  text-sm",children:e.jsxs("span",{className:"bg-blue p-1  ",children:["Total : $",a?k(a[t].usd):"-"," "]})})});return e.jsxs($,{className:"mt-5 border-quiet",children:[e.jsxs("div",{className:"flex flex-column lg:flex-row  gap-2 cursor-pointer lg:align-items-center",onClick:l,children:[e.jsxs("div",{className:"flex flex-grow-1 lg:align-items-center",children:[e.jsx("img",{src:r(),className:"max-h-2rem mr-4",alt:t}),e.jsx("div",{className:"flex-grow-1 ",children:e.jsxs("span",{className:"Panel-title font-title mb-0",children:[" ",s]})})]}),d(),e.jsxs("button",{className:"Btn Btn-nostyle ",title:"show detail",onClick:()=>o(!i),children:[e.jsx("i",{hidden:i,className:"pi pi-chevron-down"}),e.jsx("i",{hidden:!i,className:"pi pi-chevron-up"})]})]}),e.jsx("div",{hidden:!i,className:" mt-4",children:n})]})}function z(){return z=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},z.apply(this,arguments)}function ge(t){if(Array.isArray(t))return t}function he(t,s){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var a,i,o,l,r=[],d=!0,f=!1;try{if(o=(n=n.call(t)).next,s===0){if(Object(n)!==n)return;d=!1}else for(;!(d=(a=o.call(n)).done)&&(r.push(a.value),r.length!==s);d=!0);}catch(u){f=!0,i=u}finally{try{if(!d&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(f)throw i}}return r}}function j0(t,s){(s==null||s>t.length)&&(s=t.length);for(var n=0,a=new Array(s);n<s;n++)a[n]=t[n];return a}function Ce(t,s){if(t){if(typeof t=="string")return j0(t,s);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j0(t,s)}}function je(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function we(t,s){return ge(t)||he(t,s)||Ce(t,s)||je()}var V=c.memo(c.forwardRef(function(t,s){var n=c.useState(!1),a=we(n,2),i=a[0],o=a[1],l=c.useRef(null),r=c.useRef(t.inputRef),d=t.checked===t.trueValue,f=function(A){t.disabled||(u(A),v0.focus(r.current),A.preventDefault())},u=function(A){if(t.onChange){var D=d?t.falseValue:t.trueValue;t.onChange({originalEvent:A,value:D,stopPropagation:function(){},preventDefault:function(){},target:{name:t.name,id:t.id,value:D}})}},x=function(A){o(!0),t.onFocus&&t.onFocus(A)},h=function(A){o(!1),t.onBlur&&t.onBlur(A)};c.useImperativeHandle(s,function(){return{props:t,getElement:function(){return l.current},getInput:function(){return l.current}}}),c.useEffect(function(){t0.combinedRefs(r,t.inputRef)},[r,t.inputRef]);var C=t0.isNotEmpty(t.tooltip),w=t0.findDiffKeys(t,V.defaultProps),S=t0.reduceKeys(w,v0.ARIA_PROPS),M=H0("p-inputswitch p-component",{"p-inputswitch-checked":d,"p-disabled":t.disabled,"p-focus":i},t.className);return c.createElement(c.Fragment,null,c.createElement("div",z({ref:l,id:t.id,className:M,style:t.style},w,{onClick:f,role:"checkbox","aria-checked":d}),c.createElement("div",{className:"p-hidden-accessible"},c.createElement("input",z({ref:r,type:"checkbox",id:t.inputId,name:t.name,checked:d,onChange:u,onFocus:x,onBlur:h,disabled:t.disabled,role:"switch",tabIndex:t.tabIndex,"aria-checked":d},S))),c.createElement("span",{className:"p-inputswitch-slider"})),C&&c.createElement(W0,z({target:l,content:t.tooltip},t.tooltipOptions)))}));V.displayName="InputSwitch";V.defaultProps={__TYPE:"InputSwitch",checked:!1,className:null,disabled:!1,falseValue:!1,id:null,inputId:null,inputRef:null,name:null,onBlur:null,onChange:null,onFocus:null,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,trueValue:!0};function E0({tokenReward:t}){const{rewardPrice:s}=c.useContext(F),n=a=>s===void 0?"...":s[a.tokenAddress]?`$${k(a.amount*s[a.tokenAddress],!1,0)}`:"$-";return e.jsxs("div",{title:`${t.token} : ${k(t.amount)}`,className:`flex w-full lg:w-auto flex-wrap px-2 gap-2 color-quietalign-self-start align-items-center
                    border-quiet border-1 white-space-nowrap p-1 text-sm`,children:[e.jsx("img",{src:`${t.logo?.trim()||W}`,className:"h-auto w-2rem  vertical-align-middle",alt:t.token}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsxs("span",{className:"text-sm block",children:[e.jsx("span",{className:"color-tonic",children:t.token}),": ",k(t.amount)]}),e.jsx("span",{className:"text-xs block",children:n(t)})]})]})}const V0=({reward:t,isTrade:s})=>{const n=s&t.cvgSdtRatio>=1;return e.jsxs("span",{className:`flex align-items-center white-space-nowrap text-sm h-2rem ${n?"color-green":"color-red"}`,children:[k((t.cvgSdtRatio-1)*100*(s?1:-1),!0,2),"%",n?e.jsx("i",{className:"pi pi-arrow-up-right ml-2"}):e.jsx("i",{className:"pi pi-arrow-down-right ml-2"})]})};function Te({reward:t}){const{advancedMode:s,doClaim:n}=c.useContext(F),[a,i]=c.useState(!1),o=()=>{const u=U(d.toString());n(t,a,l?0:u)},l=c.useMemo(()=>t.cvgSdtRatio<N0,[t]),r=1,d=c.useMemo(()=>{let u=0;if(a){const x=S0(t.sdtRaw)*t.cvgSdtRatio;u=x-x*r/100}return u},[l,a]),f=t?.logo||W;return e.jsxs("div",{className:`grid flex-column gap-2 lg:flex-row align-items-center py-1
         border-top-1 border-quiet `,children:[e.jsx("div",{className:"col-12 lg:col-2   ",children:e.jsxs("div",{className:"flex gap-2 flex-row md:flex-column xl:flex-row align-items-center",children:[e.jsx("img",{src:f,className:"h-auto w-3rem mrt-4 vertical-align-middle",alt:t.stakingName}),e.jsx("div",{className:"vertical-align-middle py-2",children:t.stakingName})]})}),e.jsx("div",{className:"col-12 lg:col-8    gap-1 flex flex-wrap align-items-start ",children:t.items?.length?t.items?.map((u,x)=>(u.token==="cvgSDT"&&(u.logo=k0),e.jsx(E0,{tokenReward:u},x))):e.jsx("div",{})}),e.jsx("div",{className:" col-12 lg:col-1 flex-grow-0 flex gap-1  flex-wrap",children:e.jsx("div",{className:"flex align-items-center",children:e.jsxs("div",{hidden:s,children:[e.jsx(c0,{className:"Btn block text-base white-space-nowrap ",handleAction:o,children:"Claim"}),t.sdtRaw>0n&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"  flex flex-column  gap-2  w-12rem my-1 cursor-pointer  ",children:e.jsxs("span",{className:"flex gap-2 align-items-center",children:[e.jsx(V,{className:"small ",checked:a,onChange:()=>i(!a)}),e.jsx("span",{children:a?"cvgSDT":"SDT"}),e.jsx(o0,{children:e.jsxs("div",{children:["You currently have ",e.jsxs("span",{className:"color-tonic",children:[" ",A0(t?.sdtRaw,18)," SDT "]})," ","available for claim.",e.jsx("br",{})," ",e.jsx("br",{})," Alternatively, you can opt to receive cvgSDT.",e.jsx("br",{}),e.jsx("br",{}),l&&e.jsxs(e.Fragment,{children:[" ",e.jsx("span",{className:"color-tonic",children:"cvgSDT will be minted "})," directly on the cvgSDT contract 1:1"," "]}),!l&&e.jsxs(e.Fragment,{children:[" ",e.jsx("span",{className:"color-tonic",children:"cvgSDT will be traded "})," in the cvgSDT/SDT pool."," ",k((t.cvgSdtRatio-1)*100,!1,2),"%."]})]})})]})}),e.jsx("div",{children:a&&!l&&e.jsxs(e.Fragment,{children:[e.jsx(V0,{reward:{cvgSdtRatio:t.cvgSdtRatio},isTrade:!0}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs mt-2 mr-6 flex flex-wrap",children:[e.jsx("span",{className:"color-quiet",children:"Minimum receive: "}),e.jsxs("span",{children:[k(d)," cvgSDT"]})]})})]})})]})]})})})]})}function f0({type:t}){const{getDataByType:s,rewardData:n}=c.useContext(F),a=s(t),i=e.jsx("div",{className:"text-center mt-5",children:"No claimable rewards"}),o=()=>a?.length?a?.map(l=>e.jsx(Te,{reward:l},l.stakingContract)):i;return!n||n?.loading?e.jsx("div",{children:e.jsx($,{className:"border-quiet",children:e.jsx(I0,{})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" hidden  grid lg:flex color-tonic  pb-3",children:[e.jsx("div",{className:"col-2 pl-4 color-quiet",children:" Staking"}),e.jsx("div",{className:"col-8 pl-4 color-quiet",children:"Rewards"}),e.jsx("div",{className:"col-2  color-quiet",children:"Actions"})]}),e.jsx("div",{className:"flex flex-column gap-1",children:o()})]})}const r0=c.createContext(null);function ke({children:t}){const{getSigner:s}=X(),{handleTransaction:n,notifyError:a}=c.useContext(Z),[i,o]=c.useState(void 0),[l,r]=c.useState(void 0),[d,f]=c.useState(-1),[u,x]=c.useState(void 0),[h,C]=c.useState(!1),[w,S]=c.useState(!1),{rewardPrice:M,resetRewardsInfo:N}=c.useContext(F),[A,D]=c.useState(.1);c.useEffect(()=>{if(i!==void 0&&u===void 0){const v=[];i.forEach(b=>b?.tokenIds.forEach(p=>v.push(Number(p)))),x(v)}},[i]);const B=async v=>{v?(o(v),r(!0)):(r(!1),x(void 0),o(void 0))},P=c.useMemo(()=>{if(i===void 0||M===void 0)return;const v=[],b=[];return i.forEach(p=>{p.rawData.forEach(m=>{let y=0;y+=m.cvgAmount*M.cvg,m.cvgAmount&&b.push({stakingContract:m.stakingContract||"",amount:m.cvgAmount,token:"CVG",tokenAddress:"cvg",id:Number(m.tokenId),logo:m0}),m.rewards.forEach(I=>{y+=I.amount*M[I.tokenAddress]||0,b.push({stakingContract:m.stakingContract,amount:I.amount,token:I.token,tokenAddress:I.tokenAddress||"",id:Number(m.tokenId),logo:I.logo})}),v.push({tokenId:m.tokenId,id:Number(m.tokenId),total:y})})}),{totals:v,list:b}},[i,M]),E=c.useMemo(()=>{if(!P?.list?.length)return{list:[],sdt:0,total:0,cvgSDTRatio:-1};const v=P?.list.reduce((p,m)=>(p.list.push({...m}),u?.includes(m.id)&&(m?.token==="SDT"&&(p.sdt+=m.amount||0),p.total+=(m.amount||0)*(M[m.tokenAddress]||0)),p),{list:[],sdt:0,total:0}),b=p=>{f(p),S(p<1),C(p<N0)};return te.getCvgSvgSdtRatio(U(v.sdt.toString()),!1).then(b),{...v}},[P,u]),L=c.useMemo(()=>{let v=0;if(w&&!h){const b=E?.sdt*d;v=b-b*A/100}return v},[E?.sdt,A,h,w]),G=v=>{let b=[],p=0,m=[];return i.forEach(async y=>{y.rawData.filter(O=>v.includes(O.tokenId)).forEach(O=>{let _=b.find(y0=>y0.stakingContract===y.stakingContract);_||(_={stakingContract:y.stakingContract,tokenIds:[]},b.push(_)),_.tokenIds.push(O.tokenId),p+=y.cvgAmount,m.push(...O.rewards)})}),p>0&&m.push("cvg"),m=[...new Set(m)],{cvgAmount:p,allLines:b,rewardsToken:m}},j=()=>{N(),r(!1)},R={rewards:i,isVisible:l,setIsVisible:r,openClaimDialog:B,totalByTokens:P,doFilter:v=>{v=Number(v);const b=[...u||[]];u?.includes(v)?b.splice(b.indexOf(v),1):b.push(v),x(b)},filterToken:u,doClaimMultiple:async v=>{await Y(async()=>{const{allLines:p,rewardsToken:m}=G(u);return await H.claimRewardsMultiContract(p,w,v,m,await s())},j,n,a)},isMint:h,setIsMint:C,isConvert:w,setIsConvert:S,claimableDisplay:E,cvgSdtRatio:d,slippage:A,setSlippage:D,cvgSdtReceivedMin:L};return e.jsx(r0.Provider,{value:R,children:t})}function Ne({reward:t}){const{claimableDisplay:s,filterToken:n,doFilter:a}=c.useContext(r0),i=n?.includes(t.tokenId),o=c.useMemo(()=>s?.list?.filter(l=>t.stakingContract===l.stakingContract&&t.tokenId===l.id),[n]);return e.jsxs("div",{className:`grid  border-quiet align-items-center border-top-1 ${i&&"bg-green-fade"}`,onClick:()=>a(t.tokenId),children:[e.jsxs("div",{className:"col-6 lg:col-2 flex  gap-2 align-items-center  p-2 lg:px-4",children:[e.jsx("img",{className:"w-2rem",src:`/images/icon/check-${i?"selected":"none"}.svg`,alt:"row selected"}),e.jsxs("span",{children:["Tkn. ",U0(t.tokenId)]})]}),e.jsx("div",{className:"col-6 lg:col-2  ",children:e.jsxs("div",{className:" flex align-items-center  text-lg   flex gap-2 ",children:[e.jsx("img",{src:`${t.logo||W}`,className:"h-2rem",alt:t.stakingName}),e.jsxs("span",{className:"color-quiet",children:[" ",t.stakingName]})]})}),e.jsx("div",{className:"col-12  lg:col-8 flex flex-wrap my-1 gap-1    ",children:o?.map(l=>e.jsx(E0,{tokenReward:l},`${l.symbol||l.token}-${l.id}`))})]},t.stakingContract)}function Se(){const{isVisible:t,openClaimDialog:s,claimableDisplay:n,rewards:a,filterToken:i,cvgSdtRatio:o,doClaimMultiple:l,isMint:r,setIsMint:d,isConvert:f,setIsConvert:u,setSlippage:x,cvgSdtReceivedMin:h}=c.useContext(r0),C=()=>{const w=U(h?.toString());l(w)};return e.jsx(M0,{header:"Advanced claim",closable:!0,visible:t,style:{width:"80vw"},breakpoints:{"960px":"90vw","641px":"96vw"},onHide:()=>s(!1),dismissableMask:!1,children:e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("p",{className:"pb-4",children:"Select positions to claim:"}),a?.map(w=>w.rawData?.map(S=>e.jsx(Ne,{reward:S},`${w.stakingContract}-${S.tokenId}`)))]}),a?.length>1&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-lg border-quiet border-top-1 pt-4",children:["Total: $",k(n?.total,!1,2)]})}),e.jsx("div",{className:"text-center mb-5 lg:mb-0",children:e.jsxs("div",{className:" mt-5 ",children:[n?.sdt>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inline-flex align-items-center flex-column lg:flex-row justify-content-center gap-4",children:[e.jsxs("span",{className:"color-quiet flex align-items-center gap-2",children:[e.jsx(o0,{children:e.jsxs("p",{children:["You currently have"," ",e.jsxs("span",{className:"color-tonic",children:[" ",k(n?.sdt)," SDT "]})," available for claim.",e.jsx("br",{})," ",e.jsx("br",{})," Alternatively, you can opt to receive cvgSDT. If you choose this, there are two options: either",e.jsx("span",{className:"color-tonic",children:" mint "})," your cvgSDT directly on the cvgSDT contract or",e.jsx("span",{className:"color-tonic",children:" trade "})," it in the cvgSDT/SDT pool. ",e.jsx("br",{})," ",e.jsx("br",{}),"The most suitable option will be automatically chosen for you."]})}),k(n?.sdt)," SDT"]}),e.jsxs("label",{className:"  w-7rem  flex align-items-center gap-2   cursor-pointer  ",children:[e.jsx(V,{className:" ",checked:f,onChange:()=>u(!f)}),e.jsx("div",{className:"text-sm white-space-nowrap   ",children:f?"cvgSDT":"SDT"})]}),e.jsxs("label",{className:"   flex gap-2 align-items-center  cursor-pointer  ",children:[e.jsxs("div",{className:" w-7rem flex align-items-center gap-2",children:[e.jsx(V,{className:" ",checked:f&&r,disabled:!f,onChange:()=>d(!r)}),e.jsx("div",{className:"text-sm white-space-nowrap   ",children:r?"Mint":"Trade"})]}),f&&o!==-1&&e.jsx(V0,{reward:{cvgSdtRatio:o},isTrade:!r})]})]}),!r&&f&&e.jsxs("div",{children:[e.jsx("div",{className:"inline-flex text-center align-items-center flex-column lg:flex-row justify-content-center mt-2",children:e.jsx(P0,{setSlippage:x})}),e.jsxs("div",{className:"text-xs mt-2 color-quiet",children:["Minimum receive: ",e.jsxs("span",{className:"color-white",children:[" ",k(h)," "]})," cvgSDT"]})]})]}),e.jsx("div",{className:"lg:mt-5",children:e.jsx(c0,{className:"Btn",disabled:i?.length===0,handleAction:C,children:"Claim"})})]})})]})})}function Ae(){const{advancedMode:t,setAdvancedMode:s,doClaimAll:n,rewardData:a}=c.useContext(F),{openClaimDialog:i}=c.useContext(r0);return e.jsxs($,{children:[e.jsxs("div",{className:"flex flex-column lg:flex-row justify-content-between gap-2 align-items-start ",children:[e.jsx("span",{className:"Panel-title font-title",children:"Stake DAO"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex flex-wrap align-items-center color-quiet",children:["Advanced mode: ",e.jsx(V,{className:"Btn-small",checked:t,onChange:()=>s(!t)})]}),!t&&e.jsx(ae,{label:"Claim All",disabled:a===void 0,className:"Btn",handleAction:n}),t&&e.jsx("button",{hidden:!t,disabled:a===void 0,className:"Btn white-space-nowrap",onClick:()=>i(Object.values(a)),children:"Claim All+"})]})]}),e.jsx(d0,{title:"cvgSDT",type:"cvgSdt",children:e.jsx(f0,{type:"cvgSdt"})}),e.jsx(d0,{title:"sdTokens",type:"sd",children:e.jsx(f0,{type:"sd"})}),e.jsx(d0,{title:"LPs",type:"lp",children:e.jsx(f0,{type:"lp"})}),e.jsx(Se,{})]})}function Ie(){const{isWellConnected:t}=X(),{rewardData:s}=c.useContext(F);return t?s?.error?e.jsx("div",{children:e.jsx($,{children:e.jsx(O0,{})})}):e.jsx(e.Fragment,{children:e.jsx(Ae,{})}):e.jsx(e.Fragment,{})}function w0({type:t,title:s,children:n}){const{totals:a}=c.useContext(q),[i,o]=c.useState(!1),l=()=>o(!i),r=()=>({cvxAsset:K0,cvgAsset:b0})[t],d=()=>a===void 0?e.jsx("div",{className:"flex-grow-1 flex justify-content-end flex-column lg:flex-row ",children:e.jsx(l0,{className:"w-10rem p-2"})}):e.jsx("div",{className:"flex-grow-1",children:e.jsx("span",{className:"flex align-items-start justify-content-end flex-column lg:flex-row  text-sm",children:e.jsxs("span",{className:"bg-blue p-1  ",children:["Total : $",a?k(a[t].usd):"-"," "]})})});return e.jsxs($,{className:"mt-5 border-quiet",children:[e.jsxs("div",{className:"flex flex-column lg:flex-row  gap-2 cursor-pointer lg:align-items-center",onClick:l,children:[e.jsxs("div",{className:"flex flex-grow-1 lg:align-items-center",children:[e.jsx("img",{src:r(),className:"max-h-2rem mr-4",alt:t}),e.jsx("div",{className:"flex-grow-1 ",children:e.jsxs("span",{className:"Panel-title font-title mb-0",children:[" ",s]})})]}),d(),e.jsxs("button",{className:"Btn Btn-nostyle ",title:"show detail",onClick:()=>o(!i),children:[e.jsx("i",{hidden:i,className:"pi pi-chevron-down"}),e.jsx("i",{hidden:!i,className:"pi pi-chevron-up"})]})]}),e.jsx("div",{hidden:!i,className:" mt-4",children:n})]})}function $0({tokenReward:t}){const{rewardPrice:s}=c.useContext(q),n=a=>s===void 0?"...":s[a.tokenAddress]?`$${k(a.amount*s[a.tokenAddress],!1,0)}`:"$-";return e.jsxs("div",{title:`${t.token} : ${k(t.amount)}`,className:`flex w-full lg:w-auto flex-wrap px-2 gap-2 color-quietalign-self-start align-items-center
                    border-quiet border-1 white-space-nowrap p-1 text-sm`,children:[e.jsx("img",{src:`${t.logo?.trim()||W}`,className:"h-auto w-2rem  vertical-align-middle",alt:t.token}),e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsxs("span",{className:"text-sm block",children:[e.jsx("span",{className:"color-tonic",children:t.token}),": ",k(t.amount)]}),e.jsx("span",{className:"text-xs block",children:n(t)})]})]})}const B0=({reward:t,isTrade:s})=>{const n=s&t.cvgCvxRatio>=1;return e.jsxs("span",{className:`flex align-items-center white-space-nowrap text-sm h-2rem ${n?"color-green":"color-red"}`,children:[k((t.cvgCvxRatio-1)*100*(s?1:-1),!0,2),"%",n?e.jsx("i",{className:"pi pi-arrow-up-right ml-2"}):e.jsx("i",{className:"pi pi-arrow-down-right ml-2"})]})};function Me({reward:t}){const{advancedMode:s,doClaim:n}=c.useContext(q),[a,i]=c.useState(!1),o=()=>{const u=U(d.toString());n(t,a,l?0:u)},l=c.useMemo(()=>t.cvgCvxRatio<R0,[t]),r=1,d=c.useMemo(()=>{let u=0;if(a){const x=S0(t.cvxRaw)*t.cvgCvxRatio;u=x-x*r/100}return u},[l,a]),f=t?.logo||W;return e.jsxs("div",{className:`grid flex-column gap-2 lg:flex-row align-items-center py-1
         border-top-1 border-quiet `,children:[e.jsx("div",{className:"col-12 lg:col-2   ",children:e.jsxs("div",{className:"flex gap-2 flex-row md:flex-column xl:flex-row align-items-center",children:[e.jsx("img",{src:f,className:"h-auto w-3rem mrt-4 vertical-align-middle",alt:t.stakingName}),e.jsx("div",{className:"vertical-align-middle py-2",children:t.stakingName})]})}),e.jsx("div",{className:"col-12 lg:col-8    gap-1 flex flex-wrap align-items-start ",children:t.items?.length?t.items?.map((u,x)=>(u.token==="cvgCVX"&&(u.logo=b0),e.jsx($0,{tokenReward:u},x))):e.jsx("div",{})}),e.jsx("div",{className:" col-12 lg:col-1 flex-grow-0 flex gap-1  flex-wrap",children:e.jsx("div",{className:"flex align-items-center",children:e.jsxs("div",{hidden:s,children:[e.jsx(c0,{className:"Btn block text-base white-space-nowrap ",handleAction:o,children:"Claim"}),t.cvxRaw>0n&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"  flex flex-column  gap-2  w-12rem my-1 cursor-pointer  ",children:e.jsxs("span",{className:"flex gap-2 align-items-center",children:[e.jsx(V,{className:"small ",checked:a,onChange:()=>i(!a)}),e.jsx("span",{children:a?"cvgCVX":"CVX"}),e.jsx(o0,{children:e.jsxs("div",{children:["You currently have ",e.jsxs("span",{className:"color-tonic",children:[" ",A0(t?.cvxRaw,18)," CVX "]})," ","available for claim.",e.jsx("br",{})," ",e.jsx("br",{})," Alternatively, you can opt to receive cvgCVX.",e.jsx("br",{}),e.jsx("br",{}),l&&e.jsxs(e.Fragment,{children:[" ",e.jsx("span",{className:"color-tonic",children:"cvgCVX will be minted "})," directly on the cvgCVX contract 1:1"," "]}),!l&&e.jsxs(e.Fragment,{children:[" ",e.jsx("span",{className:"color-tonic",children:"cvgCVX will be traded "})," in the cvgCVX/CVX pool."," ",k((t.cvgCvxRatio-1)*100,!1,2),"%."]})]})})]})}),e.jsx("div",{children:a&&!l&&e.jsxs(e.Fragment,{children:[e.jsx(B0,{reward:{cvgCvxRatio:t.cvgCvxRatio},isTrade:!0}),e.jsx("div",{children:e.jsxs("div",{className:"text-xs mt-2 mr-6 flex flex-wrap",children:[e.jsx("span",{className:"color-quiet",children:"Minimum receive: "}),e.jsxs("span",{children:[k(d)," cvgCVX"]})]})})]})})]})]})})})]})}function T0({type:t}){const{getDataByType:s,rewardData:n}=c.useContext(q),a=s(t),i=e.jsx("div",{className:"text-center mt-5",children:"No claimable rewards"}),o=()=>a?.length?a?.map(l=>e.jsx(Me,{reward:l},l.stakingContract)):i;return!n||n?.loading?e.jsx("div",{children:e.jsx($,{className:"border-quiet",children:e.jsx(I0,{})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" hidden  grid lg:flex color-tonic  pb-3",children:[e.jsx("div",{className:"col-2 pl-4 color-quiet",children:" Staking"}),e.jsx("div",{className:"col-8 pl-4 color-quiet",children:"Rewards"}),e.jsx("div",{className:"col-2  color-quiet",children:"Actions"})]}),e.jsx("div",{className:"flex flex-column gap-1",children:o()})]})}const p0=c.createContext(null);function Re({children:t}){const{address:s,getSigner:n}=X(),{handleTransaction:a,notifyError:i}=c.useContext(Z),[o,l]=c.useState(void 0),[r,d]=c.useState(void 0),[f,u]=c.useState(-1),[x,h]=c.useState(void 0),[C,w]=c.useState(!1),[S,M]=c.useState(!1),{rewardPrice:N,resetRewardsInfo:A}=c.useContext(q),[D,B]=c.useState(.1);c.useEffect(()=>{if(o!==void 0&&x===void 0){const b=[];o.forEach(p=>p?.tokenIds.forEach(m=>b.push(m))),h(b)}},[o]);const P=async b=>{b?(l(b),d(!0)):(d(!1),h(void 0),l(void 0))},E=c.useMemo(()=>{if(o===void 0||N===void 0)return;const b=[],p=[];return o.forEach(m=>{m.rawData.forEach(y=>{let I=0;I+=y.cvgAmount*N.cvg,y.cvgAmount&&p.push({stakingContract:y.stakingContract||"",amount:y.cvgAmount,token:"CVG",tokenAddress:"cvg",id:y.tokenId,logo:m0}),y.rewards.forEach(O=>{I+=O.amount*N[O.tokenAddress]||0,p.push({stakingContract:y.stakingContract,amount:O.amount,token:O.token,tokenAddress:O.tokenAddress||"",id:y.tokenId,logo:O.logo})}),b.push({tokenId:y.tokenId,id:y.tokenId,total:I})})}),{totals:b,list:p}},[o,N]),L=c.useMemo(()=>{if(!E?.list?.length)return{list:[],cvx:0,total:0,cvgCVXRatio:-1};const b=E?.list.reduce((m,y)=>(m.list.push({...y}),x?.includes(y.id)&&(y?.token==="CVX"&&(m.cvx+=y.amount||0),m.total+=(y.amount||0)*(N[y.tokenAddress]||0)),m),{list:[],cvx:0,total:0}),p=m=>{u(m),M(m<1),w(m<R0)};return D0.getCvxCvgCvxRatio(U(b.cvx.toString())).then(p),{...b}},[E,x]),G=c.useMemo(()=>{let b=0;if(S&&!C){const p=L?.cvx*f;b=p-p*D/100}return b},[L?.cvx,D,C,S]),j=b=>{let p=[],m=0,y=[];return o.forEach(async I=>{I.rawData.filter(_=>b.includes(_.tokenId)).forEach(_=>{p.find(F0=>F0.stakingContract===I.stakingContract)||p.push(I.stakingContract),m+=I.cvgAmount,y.push(..._.rewards)})}),m>0&&y.push("cvg"),y=[...new Set(y)],{cvgAmount:m,allLines:p,rewardsToken:y}},g=()=>{A(),d(!1)},v={rewards:o,isVisible:r,setIsVisible:d,openClaimDialog:P,totalByTokens:E,doFilter:b=>{const p=[...x||[]];x?.includes(b)?p.splice(p.indexOf(b),1):p.push(b),h(p)},filterToken:x,doClaimMultiple:async b=>{await Y(async()=>{const{allLines:m,rewardsToken:y}=j(x);return await K.claimRewardsMultiContract(s,m,S,b,y,await n())},g,a,i)},isMint:C,setIsMint:w,isConvert:S,setIsConvert:M,claimableDisplay:L,cvgCvxRatio:f,slippage:D,setSlippage:B,cvgCvxReceivedMin:G};return e.jsx(p0.Provider,{value:v,children:t})}function De({reward:t}){const{claimableDisplay:s,filterToken:n,doFilter:a}=c.useContext(p0),i=n?.includes(t.tokenId),o=c.useMemo(()=>s?.list?.filter(l=>t.stakingContract===l.stakingContract&&t.tokenId===l.id),[]);return e.jsxs("div",{className:`grid  border-quiet align-items-center border-top-1 ${i&&"bg-green-fade"}`,onClick:()=>a(t.tokenId),children:[e.jsx("div",{className:"col-6 lg:col-2 flex  gap-2 align-items-center  p-2 lg:px-4",children:e.jsx("img",{className:"w-2rem",src:`/images/icon/check-${i?"selected":"none"}.svg`,alt:"row selected"})}),e.jsx("div",{className:"col-6 lg:col-2  ",children:e.jsxs("div",{className:" flex align-items-center  text-lg   flex gap-2 ",children:[e.jsx("img",{src:`${t.logo||W}`,className:"h-2rem",alt:t.stakingName}),e.jsxs("span",{className:"color-quiet",children:[" ",t.stakingName]})]})}),e.jsx("div",{className:"col-12  lg:col-8 flex flex-wrap my-1 gap-1    ",children:o?.map(l=>e.jsx($0,{tokenReward:l},`${l.symbol||l.token}-${l.id}`))})]},t.stakingContract)}function Oe(){const{isVisible:t,openClaimDialog:s,claimableDisplay:n,rewards:a,filterToken:i,cvgCvxRatio:o,doClaimMultiple:l,isMint:r,setIsMint:d,isConvert:f,setIsConvert:u,setSlippage:x,cvgCvxReceivedMin:h}=c.useContext(p0),C=()=>{const w=U(h?.toString());l(w)};return e.jsx(M0,{header:"Advanced claim",closable:!0,visible:t,style:{width:"80vw"},breakpoints:{"960px":"90vw","641px":"96vw"},onHide:()=>s(!1),dismissableMask:!1,children:e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("div",{className:"flex flex-column gap-2",children:[e.jsx("p",{className:"pb-4",children:"Select positions to claim:"}),a?.map(w=>w.rawData?.map(S=>e.jsx(De,{reward:S},`${w.stakingContract}-${S.tokenId}`)))]}),a?.length>1&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"text-lg border-quiet border-top-1 pt-4",children:["Total: $",k(n?.total,!1,2)]})}),e.jsx("div",{className:"text-center mb-5 lg:mb-0",children:e.jsxs("div",{className:" mt-5 ",children:[n?.cvx>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inline-flex align-items-center flex-column lg:flex-row justify-content-center gap-4",children:[e.jsxs("span",{className:"color-quiet flex align-items-center gap-2",children:[e.jsx(o0,{children:e.jsxs("p",{children:["You currently have"," ",e.jsxs("span",{className:"color-tonic",children:[" ",k(n?.cvx)," CVX "]})," available for claim.",e.jsx("br",{})," ",e.jsx("br",{})," Alternatively, you can opt to receive cvgCVX. If you choose this, there are two options: either",e.jsx("span",{className:"color-tonic",children:" mint "})," your cvgCVX directly on the cvgCVX contract or",e.jsx("span",{className:"color-tonic",children:" trade "})," it in the cvgCVX/CVX pool. ",e.jsx("br",{})," ",e.jsx("br",{}),"The most suitable option will be automatically chosen for you."]})}),k(n?.cvx)," CVX"]}),e.jsxs("label",{className:"  w-7rem  flex align-items-center gap-2   cursor-pointer  ",children:[e.jsx(V,{className:" ",checked:f,onChange:()=>u(!f)}),e.jsx("div",{className:"text-sm white-space-nowrap   ",children:f?"cvgCVX":"CVX"})]}),e.jsxs("label",{className:"   flex gap-2 align-items-center  cursor-pointer  ",children:[e.jsxs("div",{className:" w-7rem flex align-items-center gap-2",children:[e.jsx(V,{className:" ",checked:f&&r,disabled:!f,onChange:()=>d(!r)}),e.jsx("div",{className:"text-sm white-space-nowrap   ",children:r?"Mint":"Trade"})]}),f&&o!==-1&&e.jsx(B0,{reward:{cvgCvxRatio:o},isTrade:!r})]})]}),!r&&f&&e.jsxs("div",{children:[e.jsx("div",{className:"inline-flex text-center align-items-center flex-column lg:flex-row justify-content-center mt-2",children:e.jsx(P0,{setSlippage:x})}),e.jsxs("div",{className:"text-xs mt-2 color-quiet",children:["Minimum receive: ",e.jsxs("span",{className:"color-white",children:[" ",k(h)," "]})," cvgCVX"]})]})]}),e.jsx("div",{className:"lg:mt-5",children:e.jsx(c0,{className:"Btn",disabled:i?.length===0,handleAction:C,children:"Claim"})})]})})]})})}function Pe(){return e.jsxs($,{children:[e.jsx("div",{className:"flex flex-column lg:flex-row justify-content-between gap-2 align-items-start ",children:e.jsx("span",{className:"Panel-title font-title",children:"Convex"})}),e.jsx(w0,{title:"cvgCVX",type:"cvgAsset",children:e.jsx(T0,{type:"cvgAsset"})}),e.jsx(w0,{title:"cvxTokens",type:"cvxAsset",children:e.jsx(T0,{type:"cvxAsset"})}),e.jsx(Oe,{})]})}function Ee(){const{isWellConnected:t}=X(),{rewardData:s}=c.useContext(q);return t?s?.error?e.jsx("div",{children:e.jsx($,{children:e.jsx(O0,{})})}):e.jsx(e.Fragment,{children:e.jsx(Pe,{})}):e.jsx(e.Fragment,{})}const x0=c.createContext(null);function Ve({children:t}){const{address:s,isWellConnected:n,getSigner:a}=X(),[i,o]=c.useState(void 0),{handleTransaction:l,notifyError:r}=c.useContext(Z),{cvgPrice:d}=c.useContext(i0);c.useEffect(()=>{if(n&&i===void 0&&!i?.loading&&s){n0.getYsCvgData(s).then(C=>{o(C)});const h=setInterval(()=>{n0.getYsCvgData(s).then(C=>{o(C)})},1e4);return()=>clearInterval(h)}},[s]);const x={rewardData:i,cvgPrice:d,doClaimOnOneToken:async h=>{try{const C=await n0.doClaimOnOneToken(h,i.getRewardsCallInput,await a());l(C,()=>{})}catch(C){r(C)}},doClaimAll:async()=>{try{const h=await n0.doClaimAll(i.getRewardsCallInput,await a());l(h,()=>{})}catch(h){r(h)}}};return e.jsx(x0.Provider,{value:x,children:t})}function $e({tokenId:t,rewardsClaimable:s,projectionDollarPerToken:n}){const{doClaimOnOneToken:a}=c.useContext(x0);return e.jsxs($,{className:"flex flex-column lg:flex-row lg:align-items-center xl:column-gap-6 gap-3 mt-4 ",children:[e.jsxs("div",{className:"flex gap-2 mb-2 xl:mb-0 align-items-center",children:[e.jsx("div",{children:e.jsx("img",{className:" inline-block w-3rem ",src:m0,alt:"Convergence logo"})}),e.jsx("div",{className:"text-lg",children:e.jsxs("div",{className:"mr-5",children:[e.jsx("div",{children:"Tkn."}),e.jsxs("div",{className:" color-tonic ",children:[" ",t]})]})})]}),e.jsx("div",{className:"flex  flex-column  md:flex-row flex-grow-1 gap-2",children:s===void 0?e.jsx(e.Fragment,{}):Object.entries(s).map(([i,o],l)=>e.jsxs("div",{className:"flex  align-items-center gap-3 border-1 border-quiet p-2 ",children:[e.jsx("div",{className:"flex flex-column gap-2",children:e.jsx("img",{src:o.logo,alt:o.name||o.token,className:"w-2rem"})}),e.jsxs("div",{className:"flex flex-column gap-2 ",children:[e.jsxs("span",{className:"text-xs white-space-nowrap",children:[o.amountFormatted," ",o.token]}),e.jsxs("span",{children:[" ",o.amountDollar," $"]})]})]},l))}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm",children:"Projected monthly earnings"}),e.jsxs("div",{children:["$",k(n)]})]}),e.jsx("div",{children:e.jsx("button",{disabled:void 0,className:"Btn white-space-nowrap",onClick:()=>a(t),children:"Claim"})})]})}function Be(){const{rewardData:t,doClaimAll:s}=c.useContext(x0),n=t?.totalsClaimablePerTokens,a=t?.projectionDollarPerToken;return e.jsx("div",{children:t==null||Object.keys(t?.totalsClaimablePerTokens).length!==0&&e.jsxs($,{className:"mb-4",children:[e.jsxs("div",{className:"flex flex-column lg:flex-row justify-content-between gap-2 align-items-start ",children:[e.jsx("span",{className:"Panel-title font-title",children:"ysCVG"}),e.jsx("span",{children:e.jsx("button",{disabled:void 0,className:"Btn white-space-nowrap",onClick:()=>s(),children:"Claim All"})})]}),e.jsx("div",{className:"mt-3",children:n===void 0||n?.loading?e.jsx(l0,{className:"w-full h-4rem p-1 m-1"}):Object.entries(n).map(([i,o],l)=>e.jsx($e,{tokenId:i,rewardsClaimable:o,projectionDollarPerToken:a[i]},l))})]})})}function st(){return e.jsx("main",{className:" flex justify-content-center",children:e.jsx(z0,{children:e.jsx(ye,{children:e.jsx(Re,{children:e.jsx(ne,{children:e.jsx(Ve,{children:e.jsxs(ke,{children:[e.jsx(ve,{}),e.jsx("div",{className:"flex justify-content-center ",children:e.jsx("div",{className:"w-12 ",children:e.jsx(Be,{})})}),e.jsx("div",{className:"flex justify-content-center",children:e.jsx("div",{className:"w-12 ",children:e.jsx(Ee,{})})}),e.jsx("div",{className:"flex justify-content-center",children:e.jsx("div",{className:"w-12 mt-3",children:e.jsx(Ie,{})})})]})})})})})})})}export{st as default};
