import{r as c,e as P,$ as T,j as e,a6 as Z,ab as g,n as j,ae as $,ac as S,a2 as ne,aC as te,af as R,Y as L,ai as ie,d as oe,ao as q,aD as p,aE as re,_ as ce}from"./index-614b6d1c.js";import{C as v,A as de,a as me}from"./AllocationSlider-b467ce73.js";import{K as y}from"./KeyValueDisplay-ec59a4c2.js";import{P as xe,a as ge}from"./PageHelp-3dfbb5e1.js";import{H as E}from"./HeaderInfoPanelContainer-15db6aee.js";import{W as C}from"./WalletConnectedButton-5c407b26.js";import{S as W,M as he}from"./MaxButton-198646ac.js";import{E as V}from"./ErrorDisplay-8be22464.js";import{P as ve}from"./panel.esm-d8f41b63.js";import{P as ue}from"./ProgressMarker-94cd9f18.js";import{I as J,a as Q}from"./inputnumber.esm-7912d73a.js";import{P as Y}from"./ProcessActionButton-77d53bd6.js";import{R as O,C as K,a as D,L as A,b as z,X as M,Y as H,T as _}from"./generateCategoricalChart-3ca79930.js";import{A as X,a as w}from"./AreaChart-6867f386.js";import"./lock.service-f4c84d65.js";import"./rewards.service-40a9454a.js";import"./ysCvgClaim.service-bbde5ab6.js";import"./ValueConnectedButton-ea3b8760.js";(function(){try{var l=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},n=new Error().stack;n&&(l._sentryDebugIds=l._sentryDebugIds||{},l._sentryDebugIds[n]="620752d6-88ea-42e8-a859-4b610f5fde9c",l._sentryDebugIdIdentifier="sentry-dbid-620752d6-88ea-42e8-a859-4b610f5fde9c")}catch{}})();function je(){const{actualCycle:l,nextDistributionDurations:n}=c.useContext(P),{lockInfo:a}=c.useContext(v),{isWellConnected:i}=T();return e.jsxs(xe,{children:[e.jsxs(E,{children:[e.jsx(ge,{title:"Lock info",children:e.jsxs(e.Fragment,{children:["Locked positions are represented by an NFT. Lock your ",e.jsx("span",{className:"color-tonic",children:"CVG"})," to get:",e.jsx("br",{}),e.jsx("br",{}),"- ",e.jsx("span",{className:"color-tonic",children:"veCVG"})," (vote escrowed CVG) to vote for gauge weights and participate in Convergence’s governance",e.jsx("br",{}),e.jsx("br",{}),"- ",e.jsx("span",{className:"color-tonic",children:"mgCVG"})," (metagovernance CVG) to vote for underlying protocols gauge weights and governance proposals",e.jsx("br",{}),e.jsx("br",{}),"- ",e.jsx("span",{className:"color-tonic",children:"ysCVG"})," (yield sharing CVG) to claim a share on treasury’s yield every 3 months. Locked positions are represented by NFTs."]})}),e.jsx(y,{label:"Current Cycle",value:Number(l),className:"is-highlight"}),e.jsx(y,{label:"Next CVG rewards",value:n?.data?.durationNextCvg,className:"is-highlight"}),e.jsx(y,{label:"Next TDE",value:n?.data?.durationNextTde,className:"is-highlight"})]}),e.jsxs(E,{children:[!i&&e.jsx(Z,{}),i&&e.jsxs(e.Fragment,{children:[e.jsx(y,{label:"Total CVG locked",value:g(a?.totalCvgLocked)+" ($"+j(a?.totalCvgLockedDollar,!1,0)+")",className:"is-highlight"}),e.jsx(y,{label:"Total veCVG",value:g(a?.veTotalSupply),className:"is-highlight"}),e.jsx(y,{label:"Total ysCVG",value:g(a?.ysTotalSupply),className:"is-highlight"})]})]})]})}function B({tokenId:l,amount:n,type:a,type2:i,amount2:t,accepted:o,toogleState:s,changeState:r,isDelegated:d}){const{doRemoveDelegatee:m}=c.useContext(v),u=r.findIndex(f=>f.tokenId.toString()===l.toString()&&f.type===a)===-1?o:!o,x=()=>d?e.jsx("span",{children:"Delegated"}):o?e.jsxs("span",{className:" color-add",children:["Included ",u!==o&&e.jsx("span",{className:" color-delete",children:" ➤ Not included "})," "]}):e.jsxs("span",{className:" color-delete",children:["Not included ",u!==o&&e.jsx("span",{className:" color-add",children:" ➤ Included "})]}),b=()=>{d||s(l,a)},G=f=>{f.stopPropagation(),m(l,a)},I=()=>{if(d)return"border-quiet color-quiet bg-transparent ";const f="cursor-pointer color-white  bg-transparent ";return u===o?f+"":f+(o?"position-todelete":"position-toadd")};return e.jsx("div",{onClick:b,className:`w-full Btn-unstyle border-light-blue border-2  p-2 ${I()}`,children:e.jsxs("div",{className:"flex flex-column gap-1",children:[e.jsxs("div",{className:" flex  flex-column md:flex-row md:justify-content-between md:align-items-center   ",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex gap-2  align-items-center",children:[e.jsx("div",{children:e.jsx("img",{className:" inline-block w-3rem ",src:"/images/logo.svg",alt:""})}),e.jsx("div",{className:"text-lg",children:e.jsxs("div",{className:"  mr-5",children:[e.jsx("div",{children:"Tkn."}),e.jsx("div",{className:" color-tonic ",children:$(l)})]})})]})}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("div",{className:"flex flex-column gap-1",children:[e.jsxs("span",{className:"text-sm",children:[" ",a," amount"]}),e.jsxs("span",{className:"Form-blue-input",children:[g(n)," "]})," ",e.jsx("span",{className:"hidden md:inline"})]}),i&&e.jsxs("div",{className:"flex flex-column gap-1",children:[e.jsxs("span",{className:"text-sm",children:[" ",i," amount"]}),e.jsxs("span",{className:"Form-blue-input",children:[g(t)," "]})," ",e.jsx("span",{className:"hidden md:inline"})]})]})]}),e.jsxs("div",{className:"flex align-items-center justify-content-between h-2rem",children:[e.jsxs("div",{children:["Status: ",x()]}),!i&&e.jsx("div",{className:"text-right",children:e.jsx("button",{className:"Btn ",onClick:G,children:"Revoke delegation"})})]})]})})}function fe({toogleState:l,changeState:n}){const{delegateesInfo:a,lockInfo:i,getDelegateeIsAccepted:t}=c.useContext(v),o=s=>!i?.positions.some(r=>r.tokenId===s?.tokenId);return a?.loading||a===void 0?e.jsx("div",{children:e.jsx(S,{})}):e.jsxs("div",{className:"flex flex-column gap-6 md:flex-row",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h2",{className:"text-2xl my-2",children:" My tokens "}),e.jsx("div",{className:"flex flex-column gap-2",children:i?.positions?.filter(s=>s.veCvgActual>0n).map(s=>{const r=s?.delegatedInfo?.veCvg&&s.delegatedInfo?.veCvg!==ne;return e.jsx("div",{children:e.jsx(B,{toogleState:l,tokenId:s?.tokenId,isDelegated:r,amount:s?.veCvgActual,type:"veCVG",changeState:n,accepted:t(s?.tokenId,"owned"),type2:"mgCVG",amount2:s.mgCvg})},s?.tokenId)})||"-"})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("h2",{className:"text-2xl my-2",children:" veCVG "}),e.jsx("div",{className:"flex flex-column gap-2",children:a.veCvgPosition?.filter(o)?.length?a.veCvgPosition?.filter(o).map(s=>e.jsx("div",{children:e.jsx(B,{changeState:n,toogleState:l,tokenId:s?.tokenId,amount:s?.veCvgActual,type:"veCVG",accepted:t(s?.tokenId,"veCvg")})},s?.tokenId)):e.jsx("div",{className:"mb-4 color-quiet",children:"No delegated veCVG found."})}),e.jsx("h2",{className:"text-2xl my-2",children:" mgCVG "}),e.jsx("div",{className:"flex flex-column gap-2",children:a.mgCvgPosition?.filter(o)?.length?a.mgCvgPosition?.filter(o)?.map(s=>e.jsx("div",{children:e.jsx(B,{changeState:n,toogleState:l,tokenId:s?.tokenId,amount:s?.mgCvg,type:"mgCVG",accepted:t(s?.tokenId,"mgCvg")})},s?.tokenId)):e.jsx("div",{className:"mb-4 color-quiet",children:"No delegated mgCVG found."})})]})]})}function pe(){const{delegateesInfo:l,acceptDelegation:n}=c.useContext(v),[a,i]=c.useState([]),t=(s,r)=>{const d=a.findIndex(m=>m.tokenId.toString()===s.toString()&&m.type===r);if(d===-1)i([...a,{tokenId:s,type:r}]);else{const m=[...a];m.splice(d,1),i(m)}},o=()=>{n(a).then(()=>{i([])})};return l?.loading?e.jsx("div",{children:e.jsx(S,{})}):l?.error?e.jsx("div",{children:e.jsx(V,{})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("i",{className:"pi pi-info-circle color-tonic",title:"include : owned  token / delegatee tokens / vested seed token "}),"Current voting power",e.jsxs("span",{className:"block md:inline-block",children:[e.jsx("span",{className:"color-veCvg",children:" veCVG"}),": ",g(l?.votingPower.veCvg)]}),e.jsx("span",{className:"hidden md:inline",children:"/"}),e.jsx("span",{className:"inline-block md:inline color-mgCvg",children:" mgCVG"}),": ",g(l?.votingPower.mgCvg)]}),e.jsx("hr",{}),e.jsx(fe,{toogleState:t,changeState:a}),e.jsx("div",{className:"text-right mt-2",children:e.jsx("button",{className:"Btn mb-1 text-xl",disabled:a?.length===0,onClick:o,children:"Save"})})]})})}function Ne({data:l,lockInfo:n,action:a}){const t=Number(n?.currentCycle)>Number(l?.endCycle)?{filter:"grayscale(.8)"}:{},o=(Number(l?.tokenId)||0).toString(),s=({children:d,data:m})=>e.jsxs("div",{className:"flex-basis-20 flex flex-column gap-1",children:[e.jsxs("span",{className:"",children:[d," "]}),e.jsx("div",{className:"Form-blue-input",children:m})]}),r=()=>l?.ysActual===l?.ysTotal?g(l?.ysTotal,18):` ${g(l?.ysActual,18)} / ${g(l?.ysTotal,18)}`;return e.jsxs("div",{className:"border-1 border-light-blue p-4 pt-3 pb-2 flex gap-2 flex-column ",children:[e.jsxs("div",{className:"flex flex-column xl:flex-row gap-1 align-content-between",children:[e.jsxs("div",{className:"flex gap-2 mb-2 xl:mb-0 align-items-center",children:[e.jsx("div",{children:e.jsx("img",{className:" inline-block w-3rem ",src:"/images/logo.svg",alt:"Convergence logo",style:t})}),e.jsx("div",{className:"text-lg",children:e.jsxs("div",{className:"mr-5",children:[e.jsx("div",{children:"Tkn."}),e.jsxs("div",{className:" color-tonic ",children:[" ",$(o)]})]})})]}),e.jsxs("div",{className:"flex flex-column xl:flex-row w-full gap-1",children:[e.jsx(s,{data:g(l?.cvgLocked,18),children:"CVG Locked:"}),e.jsxs(s,{data:g(l?.veCvgActual,18),children:[e.jsx("span",{className:"color-veCvg",children:" veCVG"})," Amount:"]}),e.jsxs(s,{data:g(l?.mgCvg,18),children:[e.jsx("span",{className:"color-mgCvg",children:" mgCVG"})," Amount:"]}),e.jsxs(s,{data:r(),children:[e.jsx("span",{className:"color-ysCvg",children:" ysCVG"})," Amount:"]}),e.jsx(s,{data:te(l?.endCycle,0),children:"Lock end:"})]})]}),e.jsx("div",{className:"flex align-items-center justify-content-end flex-wrap",children:a()})]})}function Ce({data:l,className:n,lockInfo:a}){const{editLock:i,doBurnPosition:t,editDelegation:o,doCheckIn:s}=c.useContext(v),{notifications:r}=c.useContext(P),d=(Number(l?.tokenId)||0).toString(),m=r&&Object.keys(r?.checkInNeeded).length!==0?d===r?.checkInNeeded?.find(x=>x.toString()===d)?.toString():!1,h=Number(a?.currentCycle)>Number(l?.endCycle),u=()=>h?e.jsx(C,{className:"Btn",handleAction:()=>t(l?.tokenId),children:"Redeem CVG"}):e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"Btn",handleAction:()=>i(l?.tokenId),children:"Increase"}),e.jsx(C,{className:"Btn",handleAction:()=>o(l?.tokenId),children:"Delegate"}),e.jsx(C,{className:`Btn ${m&&"bg-red"}`,disabled:!m,handleAction:()=>s(l?.tokenId),children:"Check In"})]});return e.jsx(e.Fragment,{children:e.jsx(Ne,{data:l,className:n,lockInfo:a,action:u})})}function ee(){const{ysApr:l,setYsAprDialogVisible:n}=c.useContext(v),a=()=>{n(!0)};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-wrap gap-1 align-items-center justify-content-center",children:[e.jsx("span",{className:"color-quiet text-lg",children:" ysCVG vAPR:"}),e.jsx("div",{className:" inline-block px-4 py-2 bg-apr color-white ",children:e.jsxs("span",{className:"text-xl",children:[j(l?.totalApr,0,2)," %"]})}),e.jsxs("button",{type:"button",className:"p-2 Btn Btn-nostyle",onClick:a,children:[e.jsx("span",{className:"p-sr-only",children:" Open ysAPR breakdown"}),e.jsx("i",{className:"pi pi-info-circle  color-tonic"})]})]})})}function be(){const{aprDialogData:l,setYsAprDialogVisible:n,ysAprDialogVisible:a,ysApr:i}=c.useContext(v);return e.jsx(R,{header:"ysCVG APR Breakdown",closable:!0,visible:a,style:{width:"90vw",maxWidth:"45rem"},dismissableMask:!1,onHide:()=>{n(!1)},children:e.jsx(ve,{children:e.jsxs("div",{className:" p-2",children:[!l?.length&&e.jsx(S,{}),l?.error&&e.jsx(V,{}),!!l?.length&&e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex gap-2 justify-content-end align-items-center pb-2 mb-2 border-bottom-1 border-quiet text-xl",children:[e.jsx("span",{children:"vAPR"}),e.jsxs("div",{className:"px-4 py-2  bg-apr ",children:[j(i?.totalApr,!1,2)," %"]})]}),e.jsx("div",{className:"mb-5 color-quiet",children:"The amounts shown below result from the projection of treasury results over 1 year."}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-column gap-2 pb-2",children:[e.jsxs("div",{className:"hidden md:flex gap-2 flex-wrap align-items-center border-bottom-1 border-quiet  pb-2 w-full",children:[e.jsx("div",{className:"w-8rem color-quiet text-sm",children:"Token"}),e.jsx("div",{className:"w-20rem color-quiet text-sm",children:"Apr %"})]}),l?.map(t=>e.jsxs("div",{className:"flex gap-2 flex-wrap align-items-center border-bottom-1 border-quiet py-3 w-full",children:[e.jsxs("div",{className:"flex align-items-center gap-2 w-8rem ",children:[e.jsx("img",{src:`/images/token/${t.token}.webp`,alt:t.token,style:{width:"3rem"}}),e.jsx("div",{className:"bg-blue p-1 px-2 ",children:t.token})]}),e.jsx("div",{className:"w-20rem",children:e.jsx("div",{className:"",children:e.jsx(ue,{labelWidthClass:"",display:t.percentageApr,percent:t.share*100,color:"#ff0"})})})]},t.token))]})})]})]})})})}function ke(){const{isWellConnected:l}=T();return l?e.jsx(e.Fragment,{}):e.jsxs("div",{children:["You are not connected. ",e.jsx("br",{}),e.jsx(Z,{})]})}function ye(){const{lockInfo:l,editLock:n,loadDelegatees:a,delegateesInfo:i}=c.useContext(v),{actualCycle:t}=c.useContext(P),{isWellConnected:o}=T(),s=[{code:"mine",name:" My Position(s) "},{code:"delegated",name:" Delegated Position(s) ",disabled:!o}],[r,d]=c.useState(s?.at(0));c.useEffect(()=>{r?.code==="delegated"&&i===void 0&&a()},[r?.code]);const m=()=>{if(l?.error)return e.jsx(V,{});const h=()=>o?e.jsx(C,{className:"Btn Btn-nostyle ",handleAction:()=>n(-1),disabled:!t||t?.loading,children:e.jsxs("span",{children:[" ",e.jsx("i",{className:"pi pi-plus text-sm mr-1"}),"New Lock"," "]})}):e.jsx(ke,{});return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-wrap gap-2 justify-content-between",children:[e.jsx("div",{children:h()}),e.jsxs("div",{className:"flex gap-5 align-items-center",children:[e.jsx(ee,{}),e.jsx(be,{})]})]})})};return e.jsx(e.Fragment,{children:e.jsxs(L,{className:"mb-4  mt-4 md:mt-8",children:[e.jsx("div",{className:"grid ",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"  mb-4 Tab",children:e.jsx(W,{className:" m-0 inline-flex flex-wrap gap-3",optionLabel:"name",value:r,options:s,onChange:h=>{h.value&&d(h.value)}})})})}),r?.code==="mine"&&e.jsxs("div",{className:"grid relative -top-2rem",children:[e.jsx("div",{className:" col-12  ",children:m()}),l?.positions?.map(h=>e.jsx("div",{className:"col-12 md:col-6 xl:col-12",children:e.jsx(Ce,{data:h,lockInfo:l,className:"mr-2 mb-2"})},h?.tokenId))]}),r?.code==="delegated"&&e.jsx("div",{className:"grid relative -top-2rem",children:e.jsx(pe,{})})]})})}function we({className:l}){const{ecosystemInfo:n}=c.useContext(P),{walletTokenInfo:a}=c.useContext(ie),{doLock:i,updateLockParams:t,resetAfterLock:o,lockParams:s,timeOptions:r,isLockActive:d,isIncreaseLockActive:m,editLock:h}=c.useContext(v),{address:u}=T();let x=0n;a&&a[u]&&a[u].cvg?.balanceOf&&(x=a[u].cvg.balanceOf);const b=oe(x,18),G=b>0,I=()=>{h(!1),o()},f=s.amount>0&&s.duration>0?"increaseTimeAmount":s.amount>0?"increaseAmount":"increaseTime",se={increaseTimeAmount:{tokenId:s?.tokenId,lockDuration:s?.duration,value:s?.amount},increaseAmount:{tokenId:s?.tokenId,value:s?.amount},increaseTime:{tokenId:s?.tokenId,lockDuration:s?.duration}};function le(){return s?.tokenId!==-1?e.jsx(Y,{processKey:`lock.${f}`,allowanceDefinition:{contract:n?.lockingPositionService,token:{name:"CVG",tokenAddress:n?.cvgToken}},value:s?.amount,valueRaw:q(s?.amount),label:"Increase Lock",params:se[f],perform:i,afterPerform:I,disabled:!m.active,errors:m?.errors}):e.jsx(Y,{processKey:"lock.create",allowanceDefinition:{contract:n?.lockingPositionService,token:{name:"CVG",tokenAddress:n?.cvgToken}},value:s?.amount,valueRaw:q(s?.amount),label:"Create Lock",params:{tokenId:void 0,lockDuration:s?.duration},perform:i,afterPerform:I,disabled:!d.active,errors:d?.errors})}const N=({children:k,value:ae})=>e.jsxs("div",{className:"flex flex-column gap-1 flex-basis-33",children:[e.jsxs("span",{children:[k,": "]}),e.jsx("div",{className:"info-block py-3",children:ae})]});return e.jsxs("div",{className:`  ${l||""}`,children:[e.jsxs("div",{className:"flex align-items-center align-content-between",children:[e.jsxs("div",{className:"flex gap-2 mb-2 xl:mb-0 align-items-center",children:[e.jsx("div",{children:e.jsx("img",{className:" inline-block w-3rem ",src:"/images/logo.svg",alt:""})}),e.jsx("div",{className:"text-lg",children:e.jsxs("div",{className:"  mr-5",children:[e.jsx("div",{children:"Tkn."}),e.jsxs("div",{className:" color-tonic ",children:[s?.tokenId!==-1&&$(s?.tokenId),s?.tokenId===-1&&"New"]})]})})]}),e.jsx("div",{className:"text-right  max-w-5",children:e.jsx(ee,{})})]}),e.jsx("div",{children:e.jsxs("div",{className:"mt-3 flex flex-column gap-4 ",children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{children:[e.jsxs("span",{children:["Available: ",g(x,18)," CVG "]}),e.jsx(he,{setValue:()=>t("amount",b),available:b})]}),e.jsxs("label",{className:"p-sr-only",htmlFor:"amount-cvg",children:["CVG amount"," "]}),e.jsx(J,{disabled:!G,locale:"en-US",inputId:"amount-cvg",placeholder:G?"Enter CVG amount":"No CVG available",className:"appearance-none w-full  ",value:s?.amount,onChange:k=>{t("amount",k.value)},mode:"decimal",minFractionDigits:2,maxFractionDigits:4})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex align-items-center",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsxs("label",{className:"block mb-1",htmlFor:"lock-duration",children:["Lock durations (in weeks)"," "]}),e.jsx(W,{id:"lock-duration",unselectable:!1,className:"flex flex-wrap gap-1 full-border",optionLabel:"name",value:s?.timeOption,options:r,onChange:k=>t("timeOption",k.value)})]}),e.jsxs("div",{className:"",children:[e.jsx("span",{className:"block  mb-1 text-sm",children:"CVG available on:"}),e.jsx("span",{className:" w-10rem info-block inline-block",children:s?.end?.toLocaleString()||"-"})]})]}),e.jsx("div",{className:"separator"})]}),e.jsx("div",{className:"",children:s?.tokenId!==-1?e.jsx("div",{className:"flex align-items-center",children:e.jsxs("div",{className:" mb-4",children:[e.jsxs("span",{className:"color-veCvg ",children:[" veCVG: ",100-s.repartition," %"]})," -",e.jsxs("span",{className:"color-ysCvg",children:[" ysCVG: ",s.repartition," %"]}),e.jsx("br",{}),e.jsx("div",{className:"color-quiet mt-1",children:" Allocation is not updatable on existing position"})]})}):e.jsx(de,{value:s?.repartition,boundaries:[0,100],step:10,onChange:k=>{t("repartition",k)}})}),s?.existingPosition?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{value:`${g(s?.existingPosition.veCvgActual,18)} veCVG`,children:[e.jsx("span",{className:"color-veCvg",children:" veCVG "})," actual"]}),e.jsxs(N,{value:`${g(s?.existingPosition.mgCvg,18)} mgCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-mgCvg",children:" mgCVG "})," actual"]}),e.jsxs(N,{value:`${g(s?.existingPosition.ysTotal,18)} ysCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-ysCvg",children:" ysCVG "})," actual"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{value:`${j(s?.veBalance)} veCVG`,children:[e.jsx("span",{className:"color-veCvg",children:" veCVG "})," new"]}),e.jsxs(N,{value:`${j(s?.mgBalance)} mgCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-mgCvg",children:" mgCVG "})," new"]}),e.jsxs(N,{value:`${j(s?.ysBalance)} ysCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-ysCvg",children:" ysCVG "})," new"]})]})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{value:`${j(s?.veBalance)} veCVG`,children:[e.jsx("span",{className:"color-veCvg",children:" veCVG "})," received"]}),e.jsxs(N,{value:`${j(s?.mgBalance)} mgCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-mgCvg",children:" mgCVG "})," received"]}),e.jsxs(N,{value:`${j(s?.ysBalance)} ysCVG`,label:"mgCVG received",children:[e.jsx("span",{className:"color-ysCvg",children:" ysCVG "})," received"]})]}),e.jsxs("div",{className:"flex ",children:[e.jsx("div",{className:" mr-3 color-tonic  text-2xl",children:e.jsx("i",{className:"pi pi-info-circle "})}),e.jsx("div",{className:" "}),"Locking CVG is irreversible. To redeem your CVG, you will have to wait until the end of the lock duration."]}),e.jsx("div",{className:"",children:le()})]})})]})}function Ve(){const{lockParams:l,graphData:n}=c.useContext(v);function a(t){const{x:o,y:s,payload:r}=t,d=l?.getDateForAxis(r.value);return e.jsx("g",{transform:`translate(${o},${s})`,children:e.jsx("text",{x:0,y:0,dy:16,fill:"#666",children:e.jsx("tspan",{textAnchor:"middle",x:"0",style:{fontSize:"10px"},children:d})})})}function i(t){return t?.includes("old")?"":t?.replace("cvg","CVG")}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"color-ysCvg",children:"ysCVG"})," balance"]}),e.jsx(O,{height:250,className:"overflow-hidden mb-6",children:e.jsxs(X,{data:n,children:[e.jsx(K,{vertical:!1,strokeDasharray:"3 3"}),l?.getTicks().map(t=>e.jsx(D,{x:t,stroke:"#ffff00",strokeDasharray:"3 3",orient:45,isFront:!0,viewBox:{x:0,y:0,width:20,height:20},children:e.jsx(A,{value:"TDE",position:"insideTopLeft",fill:"#ffff00",fontSize:10})},t)),e.jsx(D,{x:l?.currentCycle,stroke:"#ff0000",children:e.jsx(A,{value:Number(l?.currentCycle),position:"insideTopLeft",fill:"#ff0000",fontSize:10})}),e.jsx(z,{formatter:i,display:1,iconSize:0}),e.jsx(w,{type:"stepBefore",fill:p.ys,stroke:p.ys,dot:!1,strokeWidth:3,dataKey:"ys",name:"ysCVG"}),e.jsx(w,{type:"stepBefore",stroke:p.oldYs,fill:p.oldYs,dot:!1,strokeWidth:3,dataKey:"oldYs",name:"old ysCVG"}),e.jsx(M,{dataKey:"cycle",tickLine:{stroke:"red",strokeWidth:2},ticks:l?.getTicks(),domain:l?.getDomain(),type:"number",fill:"#888",axisLine:!1,tick:e.jsx(a,{})}),e.jsx(H,{domain:[0,l?.amount],axisLine:!1,fill:"#888",tick:{fontSize:12}}),e.jsx(_,{wrapperClassName:"bg-black",formatter:j})]})}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"color-veCvg",children:"veCVG"})," & ",e.jsx("span",{className:"color-mgCvg",children:"mgCVG"})," balance"]}),e.jsx(O,{height:250,className:"overflow-hidden",children:e.jsxs(X,{data:n,children:[e.jsx(D,{x:l?.currentCycle,stroke:"#ff0000",children:e.jsx(A,{value:Number(l?.currentCycle),position:"insideTopLeft",fill:"#ff0000",fontSize:10})}),l?.getTicks().map(t=>e.jsx(D,{x:t,stroke:"#ffff00",strokeDasharray:"3 3",orient:45,isFront:!0,children:e.jsx(A,{value:"TDE",position:"insideTopLeft",fill:"#ffff00",fontSize:10})},t)),e.jsx(z,{formatter:i,display:1,iconSize:0}),e.jsx(K,{vertical:!1,strokeDasharray:"3 3"}),e.jsx(w,{type:"stepBefore",fill:p.oldVe,stroke:p.oldVe,dot:!1,strokeWidth:3,dataKey:"oldVe",name:"old veCVG",stackId:"3"}),e.jsx(w,{type:"stepBefore",fill:"none",stroke:p.oldMg,dot:!1,strokeWidth:3,dataKey:"oldMg",name:"old mgCVG",stackId:"1"}),e.jsx(w,{type:"stepBefore",fill:p.ve,stroke:p.ve,dot:!1,strokeWidth:3,dataKey:"ve",name:"veCVG",stackId:"2",fillOpacity:.5}),e.jsx(w,{type:"stepBefore",fill:"none",stroke:p.mg,dot:!1,strokeWidth:3,dataKey:"mg",name:"mgCVG",stackId:"0"}),e.jsx(M,{dataKey:"cycle",ticks:l?.getTicks(),tick:e.jsx(a,{}),domain:l?.getDomain(),type:"number",fill:"#888",axisLine:!1}),e.jsx(H,{domain:[0,l?.amount],axisLine:!1,fill:"#888",tick:{fontSize:12}}),e.jsx(_,{wrapperClassName:"bg-black",formatter:j})]})})]})}function Ge({hidden:l}){const{delegationInfo:n,doAddDelegation:a,doRemoveDelegation:i}=c.useContext(v),[t,o]=c.useState(null),[s,r]=c.useState("");function d(x){i("mgCvg",n?.tokenId,x)}function m(){a("mgCvg",n?.tokenId,s,t)}const h=(x,b)=>e.jsxs("div",{className:"flex  align-items-center flex-wrap  mt-2 ",children:[e.jsx("div",{className:"",children:e.jsx("div",{className:"w-full md:w-30rem info-block ",children:e.jsx(re,{address:x?.delegatee})})}),e.jsx("div",{className:"md:ml-5 mt-3 md:mt-0 w-7rem",children:e.jsxs("div",{className:"info-block max-w-5rem white-space-nowrap",children:[Number(x?.percentage)," %"]})}),e.jsx("div",{className:"md:ml-5 mt-3 md:mt-0 block xl:inline-block ",children:e.jsx(C,{handleAction:()=>d(x?.delegatee),className:"",children:"Revoke"})}),e.jsx("hr",{className:"md:hidden border-1 w-full color-quiet"})]},b),u=()=>n?.mgCvg?n.loading?e.jsx(S,{}):n.error?e.jsx(V,{}):n.mgCvg.length===0?e.jsx("div",{className:"text-center p-2 color-tonic",children:"No delegations "}):n?.mgCvg.length?n?.mgCvg?.map(h):e.jsx("div",{className:"color-tonic",children:"No active delegations"}):e.jsx(e.Fragment,{});return e.jsxs("div",{hidden:l,children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{children:"Enter the address you want to delegate your voting power to and the percentage of your voting power that you wish to delegate:"}),e.jsxs("div",{className:"flex flex-column md:flex-row mt-2 gap-2 w-full",children:[e.jsx(Q,{className:"flex-grow-1 max-w-30rem",placeholder:"0x...",value:s,onChange:x=>r(x.target.value)}),e.jsxs("div",{className:"  ",children:[e.jsx("span",{className:"md:hidden",children:"Percentage : "}),e.jsx(J,{className:"",prefix:"% ",size:5,placeholder:"0%",value:t,onChange:x=>o(x.value)})]}),e.jsx("div",{className:"flex",children:e.jsx(C,{className:"",handleAction:m,children:"Delegate"})})]})]}),e.jsx("div",{children:e.jsxs("div",{className:"  mt-4 flex ",children:[e.jsx("i",{className:"pi pi-info-circle mr-2 text-xl color-tonic"}),e.jsxs("p",{children:[e.jsx("span",{className:"color-mgCvg",children:"mgCVG"})," can be delegated up to 5 times, to 5 different addresses. The delegations will be active until you decide to revoke it."]})]})}),e.jsx("hr",{className:"my-4 border-quiet border-1"}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:"Active delegations"}),u()]}),e.jsxs("div",{className:"  mt-4 flex ",children:[e.jsx("i",{className:"pi pi-info-circle mr-2 text-xl color-tonic"}),e.jsx("p",{children:"Revoking your delegation will reset every delegation which is currently active."})]})]})}function U({hidden:l,type:n,children:a,title:i}){const{delegationInfo:t,doAddDelegation:o,doRemoveDelegation:s}=c.useContext(v),[r,d]=c.useState(null);function m(){s(n,t?.tokenId).then(()=>{d(null)})}function h(){o(n,t?.tokenId,r).then(()=>{d(null)})}const u=()=>t[n]?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Your ",e.jsx("span",{className:`color-${n}`,children:n?.replace("cvg","CVG")})," delagated to :"]}),e.jsxs("div",{className:"flex mt-2 flex-wrap",children:[e.jsx("div",{className:"w-30rem info-block ",children:t[n]}),e.jsx(C,{handleAction:m,children:"Revoke delegation"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:i}),e.jsx("div",{className:"flex mt-2",children:e.jsx(Q,{className:"flex-grow-1 max-w-30rem",placeholder:"0x...",value:r||"",onChange:x=>d(x.target.value)})}),e.jsx("div",{className:"flex mt-2",children:e.jsx(C,{handleAction:h,children:"Delegate"})})]});return e.jsxs("div",{className:"mt-4",hidden:l,children:[u(),e.jsxs("div",{className:"  mt-4 flex ",children:[e.jsx("i",{className:"pi pi-info-circle mr-2 text-xl color-tonic"}),e.jsx("p",{children:a})]})]})}const F=[{code:"mgCvg",name:"  mgCVG  ",ve:!0},{code:"veCVG",name:"  veCVG  ",ve:!0},{code:"ysCvg",name:"  ysCVG  ",ys:!0}];function Ie({className:l}){const{lockParams:n}=c.useContext(v);let a,i=F[0];n.repartition===100&&(a="ve",i=F[2]),n.repartition===0&&(a="ys");const[t,o]=c.useState(i);return e.jsx("div",{className:`${l||""}`,children:e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{children:" Select token to delegate"}),e.jsxs("div",{className:"mt-2 ",children:[e.jsx(W,{unselectable:!1,optionDisabled:a,className:"flex gap-1 full-border  flex-wrap ",optionLabel:"name",value:t,options:F,onChange:s=>o(s.value)}),e.jsx("hr",{className:"my-4 border-quiet border-1"})]})]}),e.jsx(Ge,{hidden:t?.code!=="mgCvg"}),e.jsx(U,{hidden:t?.code!=="ysCvg",type:"ysCvg",title:"Your shares are delegated to:",children:e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"color-ysCvg",children:"ysCVG"})," can be delegated to only one address. If you choose to delegate"," ",e.jsx("span",{className:"color-ysCvg",children:"ysCVG"}),", all you treasury shares will be delegated. The delegation will be active until you decide to revoke it."]})}),e.jsx(U,{hidden:t?.code!=="veCVG",type:"veCVG",title:"Your voting power is delegated to:",children:e.jsxs(e.Fragment,{children:["Revoking your delegation won't reset votes. If you wish to modify your ",e.jsx("span",{className:"color-veCvg",children:"veCVG"})," gauge votes, you will need to do it manually."]})})]})})}function De(){const{lockInfo:l,editLock:n,editVisible:a,delegationVisible:i,editDelegation:t}=c.useContext(v);return l?.error?e.jsx("div",{children:e.jsx(L,{children:e.jsx(V,{})})}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{}),e.jsx(R,{header:"Lock manager",closable:!0,visible:a,style:{width:"90vw"},onHide:()=>n(!1),dismissableMask:!1,children:e.jsx(L,{className:"overflow-hidden",children:e.jsxs("div",{className:"grid",children:[e.jsx(we,{className:"col-12 lg:col-7"}),e.jsx("div",{className:"col-12 lg:col-5",children:e.jsx(Ve,{})})]})})}),e.jsx(R,{header:"Delegate",visible:i,style:{minHeight:"75vh"},className:"Dialog-small",onHide:()=>t(!1),dismissableMask:!0,children:e.jsx(L,{className:" overflow-hidden",children:e.jsx(Ie,{})})})]})}function _e(){return e.jsx(me,{children:e.jsxs(ce,{children:[e.jsx(je,{className:"mb-6"}),e.jsx(De,{})]})})}export{_e as default};
